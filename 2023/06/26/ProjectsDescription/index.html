

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://s1.ax1x.com/2023/08/11/pPn4DER.jpg">
  <link rel="icon" href="https://s1.ax1x.com/2023/08/11/pPn4DER.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#252626">
  <meta name="author" content="Rocky CHEN">
  <meta name="keywords" content="">
  
    <meta name="description" content="Made by Ziyang CHEN, Rocky, 陈子阳  CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)- Made platform schools or companies can store and check applier or worker CVs on the CV Chain Platform- Back">
<meta property="og:type" content="article">
<meta property="og:title" content="All My Projects Description">
<meta property="og:url" content="http://example.com/2023/06/26/ProjectsDescription/index.html">
<meta property="og:site_name" content="Rocky Web">
<meta property="og:description" content="Made by Ziyang CHEN, Rocky, 陈子阳  CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)- Made platform schools or companies can store and check applier or worker CVs on the CV Chain Platform- Back">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pic1.zhimg.com/v2-2ef6b97216f69938663ae3c7c1aa9611_r.jpg?source=1940ef5c">
<meta property="article:published_time" content="2023-06-26T08:02:00.000Z">
<meta property="article:modified_time" content="2023-11-27T06:25:29.804Z">
<meta property="article:author" content="Rocky CHEN">
<meta property="article:tag" content="Projects">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://pic1.zhimg.com/v2-2ef6b97216f69938663ae3c7c1aa9611_r.jpg?source=1940ef5c">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>All My Projects Description - Rocky Web</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[],"cursor_effect":"fireworks"},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":true,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Rocky Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>主页 | Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-books"></i>
                <span>目录 | Contents</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-friends"></i>
                <span>伙伴 | Friends</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于 | About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-stack-overflow-fill"></i>
                <span>更多 | More</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    <span>博客 | Blog</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    <span>标签 | Tag</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://pic1.zhimg.com/v2-2ef6b97216f69938663ae3c7c1aa9611_r.jpg?source=1940ef5c') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.2)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="All My Projects Description"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Rocky CHEN
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-06-26 16:02" pubdate>
          Monday, June 26th 2023, 4:02 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          98k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          813 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> times
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">All My Projects Description</h1>
            
            
              <div class="markdown-body">
                
                <p><em><strong>Made by Ziyang CHEN, Rocky, 陈子阳</strong></em></p>
<hr>
<h1 id="CV-Chain-Blockchain-Developer-HTML-CSS-JS-Python3"><a href="#CV-Chain-Blockchain-Developer-HTML-CSS-JS-Python3" class="headerlink" title="CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)"></a>CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)</h1><p>- Made platform schools or companies can store and check applier or worker CVs on the CV Chain Platform<br>- Backend Technology using Blockchain &amp; Web Development</p>
<p>Github: <a target="_blank" rel="noopener" href="https://github.com/Team-Unhackable/CV-Chain">https://github.com/Team-Unhackable/CV-Chain</a></p>
<p>Website: <a target="_blank" rel="noopener" href="https://cvchain.skyproton.org/">https://cvchain.skyproton.org/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># This Python script is a simple implementation of a blockchain using the Flask web framework. It also interacts with the LeanCloud platform, a backend as a service provider, to handle user data.</span><br><span class="hljs-comment"># 此 Python 脚本是使用 Flask Web 框架的区块链的简单实现。 它还与作为服务提供商的后端 LeanCloud 平台进行交互，以处理用户数据。</span><br><br><span class="hljs-comment"># Imports necessary modules: The script begins by importing various Python modules such as datetime, json, hashlib, os, and flask. It also imports the leancloud module to interact with LeanCloud. </span><br><span class="hljs-comment"># 导入必要的模块：该脚本首先导入各种 Python 模块，例如 datetime、json、hashlib、os 和flask。 它还导入leancloud模块来与LeanCloud交互。</span><br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify<br><span class="hljs-keyword">import</span> leancloud<br><br><span class="hljs-comment"># Initializes LeanCloud: The leancloud.init() function is called with two empty strings as arguments. Normally, you should replace the &quot;&quot; with your LeanCloud Application ID and Master Key.</span><br><span class="hljs-comment"># 初始化LeanCloud：使用两个空字符串作为参数调用leancloud.init()函数。 通常，这些将是您的 LeanCloud 应用程序 ID 和主密钥。</span><br>leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># Blockchain class: A Blockchain class is defined which has various methods associated with it such as __init__, create_blockchain, get_previous_block, proof_of_work, hash, and is_chain_valid. These methods are used to create a new blockchain, add blocks to the chain, validate the blockchain, and perform other related functions.</span><br><span class="hljs-comment"># 区块链类：定义了一个区块链类，它具有与其关联的各种方法，例如 __init__、create_blockchain、get_previous_block、proof_of_work、hash 和 is_chain_valid。 这些方法用于创建新的区块链、向链添加区块、验证区块链以及执行其他相关功能。</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Blockchain</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.chain = []<br>        self.create_blockchain(proof=<span class="hljs-number">1</span>, previous_hash=<span class="hljs-string">&#x27;0&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_blockchain</span>(<span class="hljs-params">self, proof, previous_hash</span>):<br>        block = &#123;<br>            <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-built_in">len</span>(self.chain) + <span class="hljs-number">1</span>,<br>            <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-built_in">str</span>(datetime.datetime.now()),<br>            <span class="hljs-string">&#x27;proof&#x27;</span>: proof,<br>            <span class="hljs-string">&#x27;previous_hash&#x27;</span>: previous_hash<br>        &#125;<br>        self.chain.append(block)<br>        <span class="hljs-keyword">return</span> block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_previous_block</span>(<span class="hljs-params">self</span>):<br>        last_block = self.chain[-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">return</span> last_block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self, previous_proof</span>):<br>        new_proof = <span class="hljs-number">1</span><br>        check_proof = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">while</span> check_proof <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span>:<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(new_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] == <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                check_proof = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>:<br>                new_proof += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> new_proof<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">self, block</span>):  <span class="hljs-comment"># generate a hash of an entire block</span><br>        encoded_block = json.dumps(block, sort_keys=<span class="hljs-literal">True</span>).encode()<br>        <span class="hljs-keyword">return</span> hashlib.sha256(encoded_block).hexdigest()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_chain_valid</span>(<span class="hljs-params">self, chain</span>):  <span class="hljs-comment"># check if the blockchain is valid</span><br>        previous_block = chain[<span class="hljs-number">0</span>]<br>        block_index = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> block_index &lt; <span class="hljs-built_in">len</span>(chain):<br>            block = chain[block_index]<br>            <span class="hljs-keyword">if</span> block[<span class="hljs-string">&quot;previous_hash&quot;</span>] != self.<span class="hljs-built_in">hash</span>(previous_block):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            current_proof = block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(current_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] != <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_block = block<br>            block_index += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-comment"># Flask application setup: A Flask application is instantiated and a new Blockchain object is created.</span><br><span class="hljs-comment"># Flask 应用程序设置：实例化 Flask 应用程序并创建新的区块链对象。</span><br>app = Flask(__name__)<br><br>blockchain = Blockchain()<br><br><span class="hljs-comment"># def cache_read():</span><br><span class="hljs-comment">#     url = &quot;https://skyproton.org/save/cache.txt&quot;</span><br><span class="hljs-comment">#     file = urllib.request.urlopen(url)</span><br><span class="hljs-comment">#     name = file.readlines()[0].decode(&quot;utf-8&quot;)</span><br><span class="hljs-comment">#     name = name.strip(&#x27;\n&#x27;)</span><br><span class="hljs-comment">#     return name</span><br><br><br><span class="hljs-comment"># LeanCloud interaction functions: Several functions are defined to interact with LeanCloud, including getCacheUserNameList, updateUserNameIndex, hasIndex, and getUserName. These functions retrieve user data from LeanCloud, update user data, and perform other related operations.</span><br><span class="hljs-comment"># LeanCloud交互函数：定义了几个与LeanCloud交互的函数，包括getCacheUserNameList、updateUserNameIndex、hasIndex和getUserName。 这些函数从 LeanCloud 检索用户数据、更新用户数据并执行其他相关操作。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheUserNameList</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">list</span> = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;blockIndex&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query.descending(<span class="hljs-string">&#x27;createdAt&#x27;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>        <span class="hljs-built_in">list</span>.append(user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>))<br>        user.save()<br>    <span class="hljs-comment"># if len(user_list) &gt; 0:</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">updateUserNameIndex</span>(<span class="hljs-params">inUserName, inIndex</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-comment"># for user in user_list:</span><br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;username&#x27;</span>) == inUserName <span class="hljs-keyword">and</span> user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) == <span class="hljs-string">&quot;&quot;</span>):<br>            user.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;blockIndex&#x27;</span>,<span class="hljs-built_in">str</span>(inIndex))<br>            user.save()<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hasIndex</span>(<span class="hljs-params">inUserName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) != <span class="hljs-string">&quot;&quot;</span>):<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUserName</span>(<span class="hljs-params">inRealName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    outName = <span class="hljs-string">&#x27;&#x27;</span><br>    flag = <span class="hljs-literal">False</span><br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>, <span class="hljs-built_in">str</span>(inRealName))<br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>            <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>) == inRealName):<br>                outName = user.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>                flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span> (flag):<br>        <span class="hljs-keyword">return</span> outName<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> flag<br><br><br><span class="hljs-comment"># def addUsersIntoBlock():</span><br><span class="hljs-comment">#     userList = []</span><br><span class="hljs-comment">#     # while (len(userList)==0):</span><br><span class="hljs-comment">#     userList = getCacheUserNameList()</span><br><span class="hljs-comment">#     if (len(userList)!=0):</span><br><span class="hljs-comment">#         for user in userList:</span><br><span class="hljs-comment">#             return block_data(user)</span><br><br><span class="hljs-comment"># Flask routes: Two Flask routes are defined, /block_data and /get_chain. The /block_data route is a GET route that retrieves a list of usernames from LeanCloud, adds them to the blockchain, and writes the blockchain data to JSON files. The /get_chain route is also a GET route that returns the entire blockchain and its length.</span><br><span class="hljs-comment"># Flask 路由：定义了两个 Flask 路由，/block_data 和 /get_chain。 /block_data 路由是一个 GET 路由，它从 LeanCloud 检索用户名列表，将它们添加到区块链，并将区块链数据写入 JSON 文件。 /get_chain 路由也是一个 GET 路由，它返回整个区块链及其长度。</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/block_data&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">block_data</span>():<br>    inNameList = getCacheUserNameList()<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">len</span>(inNameList)&gt;<span class="hljs-number">0</span>):<br>        inName = inNameList.pop()<br>        previous_block = blockchain.get_previous_block()<br>        previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>        proof = blockchain.proof_of_work(previous_proof)<br>        previous_hash = blockchain.<span class="hljs-built_in">hash</span>(previous_block)<br>        block = blockchain.create_blockchain(proof, previous_hash)<br>        response = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: inName,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: block[<span class="hljs-string">&#x27;index&#x27;</span>],<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: block[<span class="hljs-string">&#x27;timestamp&#x27;</span>],<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: block[<span class="hljs-string">&#x27;proof&#x27;</span>],<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: block[<span class="hljs-string">&#x27;previous_hash&#x27;</span>]&#125;<br>        <br>        username = getUserName(inName)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> hasIndex(username)):<br>            updateUserNameIndex(username, block[<span class="hljs-string">&#x27;index&#x27;</span>])<br><br>        json_object = json.dumps(response, indent = <span class="hljs-number">5</span>)<br>    <br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./data/main/main_block_&quot;</span> + <span class="hljs-built_in">str</span>(block[<span class="hljs-string">&#x27;index&#x27;</span>]) + <span class="hljs-string">&quot;.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(json_object)<br>        <br>        os.mkdir(<span class="hljs-string">&quot;./data/&quot;</span> + <span class="hljs-built_in">str</span>(block[<span class="hljs-string">&#x27;index&#x27;</span>]))<br><br>        count = &#123;<span class="hljs-string">&#x27;num&#x27;</span>: <span class="hljs-built_in">len</span>(blockchain.chain)<br>        &#125;<br>        json_count = json.dumps(count, indent = <span class="hljs-number">1</span>)<br>    <br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./count/main.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(json_count)<br>        <br><br>        <span class="hljs-comment">#return jsonify(response), 200</span><br>    <span class="hljs-keyword">return</span> jsonify(response = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: <span class="hljs-literal">None</span>&#125;), <span class="hljs-number">200</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/get_chain&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_chain</span>():<br>    response = &#123;<span class="hljs-string">&#x27;chain&#x27;</span>: blockchain.chain,<br>                <span class="hljs-string">&#x27;length&#x27;</span>: <span class="hljs-built_in">len</span>(blockchain.chain)&#125;<br>    <span class="hljs-keyword">return</span> jsonify(response), <span class="hljs-number">200</span><br><br><span class="hljs-comment"># Application run: Finally, the Flask application is run on host &#x27;0.0.0.0&#x27; and port 5001.</span><br><span class="hljs-comment"># 应用程序运行：最后，Flask 应用程序在主机“0.0.0.0”和端口 5001 上运行。</span><br>app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5001</span>)<br></code></pre></td></tr></table></figure>

<p>The script is part of a larger system. It is designed to create a blockchain, add blocks to the chain when new users are added to the LeanCloud service, and provide a way to retrieve the entire blockchain via a web API. It also creates a new directory for each block and two JSON <em>&#x2F;<em>ˈdʒeɪsn</em>&#x2F;</em> files: one that contains the block data and another that contains the current length of the chain.<br>该脚本是更大系统的一部分。 它旨在创建一个区块链，当新用户添加到 LeanCloud 服务时将区块添加到链中，并提供一种通过 Web API 检索整个区块链的方法。 它还为每个块创建一个新目录和两个 JSON 文件：一个包含块数据，另一个包含链的当前长度。</p>
<p>This is a very basic implementation of a blockchain. It lacks elements like peer-to-peer network, consensus algorithm for resolving conflicts, transaction handling, etc. that you would find in a full-fledged blockchain system like Bitcoin or Ethereum.<br>这是区块链的一个非常基本的实现。它缺乏点对点网络、解决冲突的共识算法、交易处理等元素，而这些元素你会在比特币或以太坊等成熟的区块链系统中找到。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> leancloud<br><br><span class="hljs-comment"># 定义了一个名为getCacheUserNameListLen()的函数，该函数使用LeanCloud的SDK连接到云端数据库，并查询名为UserData的表格中，blockIndex字段为空的记录的数量，并返回该数量。</span><br><span class="hljs-comment"># A function named getCacheUserNameListLen() is defined that uses LeanCloud&#x27;s SDK to connect to the cloud database and query the number of records in a table named UserData with the blockIndex field empty and return that number.</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheUserNameListLen</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">list</span> = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;blockIndex&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(user_list)<br>  <br><span class="hljs-comment"># 使用一个while循环，不断地向URL http://127.0.0.1:5001/block_data 发送GET请求，每隔5秒钟进行一次请求。</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    URL = <span class="hljs-string">&quot;http://127.0.0.1:5001/block_data&quot;</span><br>    <span class="hljs-keyword">if</span> (getCacheUserNameListLen()&gt;<span class="hljs-number">0</span>): <span class="hljs-comment"># 在每次循环中，如果getCacheUserNameListLen()函数返回的值大于0</span><br>        r = requests.get(url = URL)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Get&quot;</span>) <span class="hljs-comment"># 则打印&quot;Get&quot;，表示可以发送请求；</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wait&quot;</span>) <span class="hljs-comment"># 否则打印&quot;Wait&quot;，表示需要等待。</span><br>    time.sleep(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> leancloud<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># 定义了一个名为getCacheBusinessListLen()的函数，该函数使用LeanCloud的SDK连接到云端数据库，并查询名为UserData的表格中，isAdded字段为&quot;f&quot;的记录的数量，并返回该数量。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheBusinessListLen</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    bList = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;isAdded&#x27;</span>, <span class="hljs-string">&quot;f&quot;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(user_list)<br>  <br><span class="hljs-comment"># 使用一个while循环，不断地向URL http://127.0.0.1:5002/block_data 发送GET请求，每隔5秒钟进行一次请求。</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    URL = <span class="hljs-string">&quot;http://127.0.0.1:5002/block_data&quot;</span><br>    <span class="hljs-keyword">if</span> (getCacheBusinessListLen()&gt;<span class="hljs-number">0</span>): <span class="hljs-comment"># 在每次循环中，如果getCacheBusinessListLen()函数返回的值大于0</span><br>        r = requests.get(url = URL)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Get&quot;</span>) <span class="hljs-comment"># 则打印&quot;Get&quot;，表示可以发送请求</span><br>        <br>        <span class="hljs-comment"># 在请求成功后，程序会扫描指定目录下的文件，获取文件数量并将文件序号存储到JSON文件中。</span><br>        <span class="hljs-comment"># 具体来说，程序会遍历目录&quot;/var/www/html/blockchain/data&quot;下的所有文件夹。</span><br>        <span class="hljs-comment"># 对于每个文件夹，如果它包含文件，则程序会找到该文件夹中编号最大的文件，</span><br>        <span class="hljs-comment"># 并将该文件的序号减1写入一个名为&quot;&#123;文件夹编号&#125;.json&quot;的JSON文件中，存储在&quot;./count&quot;目录下。</span><br>        path = <span class="hljs-string">&quot;/var/www/html/blockchain/data&quot;</span><br>        <span class="hljs-built_in">list</span> = os.listdir(path)<br>        number_files = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, number_files+<span class="hljs-number">1</span>):<br>            path = <span class="hljs-string">&quot;/var/www/html/blockchain/data/&quot;</span> + <span class="hljs-built_in">str</span>(i)<br>            subdata_file = os.listdir(path)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(subdata_file) &gt; <span class="hljs-number">0</span>:<br>                index = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">max</span>(subdata_file)[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span><br>                num = &#123;<span class="hljs-string">&#x27;num&#x27;</span>: index&#125;<br>                json_object = json.dumps(num, indent = <span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./count/&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>                    outfile.write(json_object)<br>        <br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wait&quot;</span>) <span class="hljs-comment"># 否则打印&quot;Wait&quot;，表示需要等待。</span><br>    time.sleep(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify<br><span class="hljs-keyword">import</span> leancloud<br><br><span class="hljs-comment"># 区块链类：该类是区块链系统的核心。 它包含处理区块链操作的各种方法，例如创建新区块 (create_blockchain)、获取前一个区块 (get_previous_block)、执行工作证明 (proof_of_work)、为区块生成哈希 (hash) 以及验证区块链 (is_chain_valid)。</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Blockchain</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.chain = []<br>        self.create_blockchain(proof=<span class="hljs-number">1</span>, previous_hash=<span class="hljs-string">&#x27;0&#x27;</span>, UID=<span class="hljs-string">&#x27;0&#x27;</span>, index=<span class="hljs-string">&#x27;1&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_blockchain</span>(<span class="hljs-params">self, proof, previous_hash, UID, index</span>):<br>        <span class="hljs-comment">#index_1 = os.path.splitext(&quot;./data/&quot; + str(UID) + &quot;/&quot; + str(index) + &quot;.json&quot;)[0]</span><br>        block = &#123;<br>            <span class="hljs-comment">#&#x27;index&#x27;: int(index_1[-1:]) + 1,</span><br>            <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-built_in">int</span>(index) + <span class="hljs-number">1</span>,<br>            <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-built_in">str</span>(datetime.datetime.now()),<br>            <span class="hljs-string">&#x27;proof&#x27;</span>: proof,<br>            <span class="hljs-string">&#x27;previous_hash&#x27;</span>: previous_hash<br>        &#125;<br>        self.chain.append(block)<br>        <span class="hljs-keyword">return</span> block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_previous_block</span>(<span class="hljs-params">self</span>):<br>        last_block = self.chain[-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">return</span> last_block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self, previous_proof</span>):<br>        new_proof = <span class="hljs-number">1</span><br>        check_proof = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">while</span> check_proof <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span>:<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(new_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] == <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                check_proof = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>:<br>                new_proof += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> new_proof<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">self, block</span>):  <span class="hljs-comment"># generate a hash of an entire block</span><br>        encoded_block = json.dumps(block, sort_keys=<span class="hljs-literal">True</span>).encode()<br>        <span class="hljs-keyword">return</span> hashlib.sha256(encoded_block).hexdigest()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_chain_valid</span>(<span class="hljs-params">self, chain</span>):  <span class="hljs-comment"># check if the blockchain is valid</span><br>        previous_block = chain[<span class="hljs-number">0</span>]<br>        block_index = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> block_index &lt; <span class="hljs-built_in">len</span>(chain):<br>            block = chain[block_index]<br>            <span class="hljs-keyword">if</span> block[<span class="hljs-string">&quot;previous_hash&quot;</span>] != self.<span class="hljs-built_in">hash</span>(previous_block):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            current_proof = block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(current_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] != <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_block = block<br>            block_index += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-comment"># Flask 应用程序：Flask 应用程序提供与区块链系统交互的接口。 路由 /block_data 是处理区块链操作的端点。 它从 LeanCloud 获取业务列表，对于每个业务，它执行工作量证明，在区块链中创建一个新块，然后将此块数据作为 json 文件保存在特定目录中。</span><br><span class="hljs-comment"># Flask app: The Flask application provides an interface to interact with the blockchain system. The route /block_data is the endpoint where the blockchain operations are handled. It fetches the business list from LeanCloud, and for each business, it performs a proof of work, creates a new block in the blockchain and then saves this block data as a json file in a specific directory.</span><br>app = Flask(__name__)<br><br>blockchain = Blockchain()<br><br><span class="hljs-comment"># def cache_read(): 被注释掉，与缓存和更新用户数据等附加功能有关，但当前代码中并未使用它们。</span><br><span class="hljs-comment">#     url = &quot;https://skyproton.org/save/cache.txt&quot;</span><br><span class="hljs-comment">#     file = urllib.request.urlopen(url)</span><br><span class="hljs-comment">#     name = file.readlines()[0].decode(&quot;utf-8&quot;)</span><br><span class="hljs-comment">#     name = name.strip(&#x27;\n&#x27;)</span><br><span class="hljs-comment">#     return name</span><br><br><span class="hljs-comment"># LeanCloud 操作：该代码包含多个与 LeanCloud 服务交互以存储和获取数据的函数。 </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheUserNameList</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">list</span> = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;blockIndex&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query.descending(<span class="hljs-string">&#x27;createdAt&#x27;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>        <span class="hljs-built_in">list</span>.append(user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>))<br>        user.save()<br>    <span class="hljs-comment"># if len(user_list) &gt; 0:</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">updateUserNameIndex</span>(<span class="hljs-params">inUserName, inIndex</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-comment"># for user in user_list:</span><br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;username&#x27;</span>) == inUserName <span class="hljs-keyword">and</span> user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) == <span class="hljs-string">&quot;&quot;</span>):<br>            user.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;blockIndex&#x27;</span>,<span class="hljs-built_in">str</span>(inIndex))<br>            user.save()<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hasIndex</span>(<span class="hljs-params">inUserName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) != <span class="hljs-string">&quot;&quot;</span>):<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUserName</span>(<span class="hljs-params">inRealName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    outName = <span class="hljs-string">&#x27;&#x27;</span><br>    flag = <span class="hljs-literal">False</span><br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>, <span class="hljs-built_in">str</span>(inRealName))<br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>            <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>) == inRealName):<br>                outName = user.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>                flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span> (flag):<br>        <span class="hljs-keyword">return</span> outName<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-comment"># 例如，getCacheBusinessList 获取尚未添加到区块链的企业列表（其中“isAdded”等于“f”）。 然后，这些业务将被添加到区块链中并标记为已添加（将“isAdded”设置为“t”）。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheBusinessList</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    bList = <span class="hljs-built_in">list</span>()<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;isAdded&#x27;</span>, <span class="hljs-string">&quot;f&quot;</span>)<br>    query.descending(<span class="hljs-string">&#x27;createdAt&#x27;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>        inList = <span class="hljs-built_in">list</span>()<br>        inList.append(user.get(<span class="hljs-string">&#x27;UID&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;companyType&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;companyName&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;DegreeOrJob&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;ClassOrYear&#x27;</span>))<br>        bList.append(inList)<br>        user.<span class="hljs-built_in">set</span>(<span class="hljs-string">&quot;isAdded&quot;</span>,<span class="hljs-string">&quot;t&quot;</span>)<br>        user.save()<br>    <span class="hljs-keyword">return</span> bList<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/block_data&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">block_data</span>():<br>    inNameList = getCacheBusinessList()<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">len</span>(inNameList)&gt;<span class="hljs-number">0</span>):<br>        inName = inNameList.pop()<br>        UID = inName[<span class="hljs-number">0</span>]<br>        inType = inName[<span class="hljs-number">1</span>]<br>        inBName = inName[<span class="hljs-number">2</span>]<br>        inData_1 = inName[<span class="hljs-number">3</span>]<br>        inData_2 = inName[<span class="hljs-number">4</span>]<br>        previous_block = blockchain.get_previous_block()<br>        previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>        proof = blockchain.proof_of_work(previous_proof)<br>        previous_hash = blockchain.<span class="hljs-built_in">hash</span>(previous_block)<br><br>        path = <span class="hljs-string">&quot;/var/www/html/blockchain/data/&quot;</span> + <span class="hljs-built_in">str</span>(UID)<br>        subdata_file = os.listdir(path)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(subdata_file) &gt; <span class="hljs-number">0</span>:<br>            index = <span class="hljs-built_in">max</span>(subdata_file)[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">else</span>:<br>            index = <span class="hljs-number">1</span><br><br>        block = blockchain.create_blockchain(proof, previous_hash, UID, index)<br>        response = &#123;<span class="hljs-string">&#x27;type&#x27;</span>: inType,<br>                    <span class="hljs-string">&#x27;data&#x27;</span>: &#123;<br>                        <span class="hljs-string">&#x27;Name_of_Work_or_Study&#x27;</span>: inBName,<br>                        <span class="hljs-string">&#x27;data_1&#x27;</span>: inData_1,<br>                        <span class="hljs-string">&#x27;data_2&#x27;</span>: inData_2,<br>                    &#125;,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: block[<span class="hljs-string">&#x27;index&#x27;</span>],<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: block[<span class="hljs-string">&#x27;timestamp&#x27;</span>],<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: block[<span class="hljs-string">&#x27;proof&#x27;</span>],<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: block[<span class="hljs-string">&#x27;previous_hash&#x27;</span>]&#125;<br>        <br>        <span class="hljs-comment"># username = getUserName(inName)</span><br>        <span class="hljs-comment"># if (not hasIndex(username)):</span><br>        <span class="hljs-comment">#     updateUserNameIndex(username, block[&#x27;index&#x27;])</span><br><br>        json_object = json.dumps(response, indent = <span class="hljs-number">5</span>)<br>    <br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./data/&quot;</span> + <span class="hljs-built_in">str</span>(UID) + <span class="hljs-string">&quot;/&quot;</span> + <span class="hljs-built_in">str</span>(block[<span class="hljs-string">&#x27;index&#x27;</span>]) + <span class="hljs-string">&quot;.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(json_object)<br><br>        <span class="hljs-comment">#return jsonify(response), 200</span><br>    <span class="hljs-keyword">return</span> jsonify(response = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: <span class="hljs-literal">None</span>&#125;), <span class="hljs-number">200</span><br><br>app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5002</span>) <span class="hljs-comment"># 应用程序运行：最后一行在主机“0.0.0.0”和端口 5002 上运行 Flask 应用程序。</span><br></code></pre></td></tr></table></figure>



<h1 id="A-Blockchain-Implementation-C"><a href="#A-Blockchain-Implementation-C" class="headerlink" title="A Blockchain Implementation (C++)"></a>A Blockchain Implementation (C++)</h1><p>- This program is about Blockchain which is a cryptographic tool. The goal is to be used in Fintech to protect the chronological order of transactions. The user can use this program to store the information that he wants to save, the information can neither be deleted nor modified. And provide the function of displaying chain data to facilitate user queries. If there are malicious changes to transaction data, the program detects and reflects them.<br>- 这个是一个关于加密工具区块链的程序。目标是在金融科技中使用，以保护交易的时间顺序。用户可以使用这个程序来存储他想要保存的信息，这些信息既不能删除也不能修改。并提供链数据显示功能，方便用户查询。如果存在对事务数据的恶意更改，程序将检测并反映这些更改。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// First of all, here is the library of the program. It includes 3 libraries and given files hpp. and a cpp.</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;SHA1.hpp&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;SHA1.cpp&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX 1000</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// The program designs two structures, namely Block and Blockchain. Among them, the Block structure contains the data, number, hash value, and previous hash value of the Block. In order to facilitate the calculation, when we designed the Blockchain structure, we maintained an array of Blocks with a capacity of 1000 and recorded the number of Blocks in the current Blockchain.</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Block</span> &#123; <span class="hljs-comment">// here is the structure of block</span><br>    string Data;  <span class="hljs-comment">// The data that the user wants to enter(store)</span><br>    <span class="hljs-type">int</span> Number; <span class="hljs-comment">// the index of the blocks</span><br>    string p_hash; <span class="hljs-comment">// previous hash value</span><br>    string hash; <span class="hljs-comment">// hash value</span><br>&#125;;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Blockchain</span>&#123; <span class="hljs-comment">// here is the structure of blockchain which is including blocks</span><br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Block</span> BlockArray[MAX]; <span class="hljs-comment">// By default, 1000 blocks can be added</span><br>    <span class="hljs-type">int</span> m_Size;<br>&#125;;<br><br><span class="hljs-comment">// The project is built on the blockchain. This program allows the user to perform four operations: 1. Add a new block 2. Display the chain data 3. Check the integrity of the data 0. Exit the program If the user writes numbers other than these four, such as 4, 5, 6. The system redisplays the menu and asks the user to retype. When the user enters 0 to exit the program.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">showMenu</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// display the menu</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;******************************************************************************************&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;**************************************** Blockchain **************************************&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;********* This is the blockchain menu, you can run related functions by number ***********&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  1. Add a new block                                    *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  2. Search block by given information                  *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  3. Check the integrity of the data                    *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  0. Exit the program                                   *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;******************************************************************************************&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// Regarding the first operation, the user can add blocks by himself, store the information (data) that the user wants to store into the blocks, and generate a hash value to ensure security. First, the program checks whether the blockchain&#x27;s memory is full and if not, the following operations are performed.</span><br><span class="hljs-comment">// The system will ask the number of blocks the user wants to add. And then the user could enter the information(data) into it. If x blocks are added successfully, the system will display &quot;You have added x block(s) successfully!!! &quot;. After the user enters the information, the system will automatically calculate its hash value. And store the information of the block in the corresponding structure.</span><br><span class="hljs-comment">// After the first function completes, the system displays the menu again to the user, allowing the user to choose the next step.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addBlocks</span><span class="hljs-params">(Blockchain * blo)</span></span>&#123; <span class="hljs-comment">// This is the function to add blocks</span><br>    <span class="hljs-keyword">if</span> (blo -&gt; m_Size == MAX) &#123; <span class="hljs-comment">// Blocks cannot be added if they reach 1000</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;Adding failure!&quot;</span> &lt;&lt; endl;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Enter the number of blocks you want to add: &quot;</span>;<br>        <span class="hljs-type">int</span> addNum = <span class="hljs-number">0</span>; <span class="hljs-comment">// Initialize the number of blocks that user want to add</span><br>        cin &gt;&gt; addNum;<br>        <span class="hljs-keyword">if</span> (addNum &gt; <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-comment">// Calculate the new space size, the adding number should not be negative</span><br>            <span class="hljs-type">int</span> newSize; <span class="hljs-comment">// 0</span><br>            newSize = blo-&gt;m_Size + addNum;<br>            string data = <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// Initialize the data of block</span><br>            string p_hash = <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// Initialize the previous hash of block</span><br>            <br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size != <span class="hljs-number">0</span>)&#123;<br>                p_hash = blo-&gt;BlockArray[blo-&gt;m_Size - <span class="hljs-number">1</span>].hash; <span class="hljs-comment">// in case previous hash become the initialize value</span><br>            &#125;<br>            <br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = blo-&gt;m_Size; i &lt; newSize; i++) &#123; <span class="hljs-comment">// i = 0, i &lt; 2</span><br>                cout &lt;&lt; endl;<br>                cout&lt;&lt;<span class="hljs-string">&quot;***** Please enter the information of block No.&quot;</span>&lt;&lt;i+<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-string">&quot; *****&quot;</span>&lt;&lt;endl;<br>                cout&lt;&lt;<span class="hljs-string">&quot;\tPlease enter the data: &quot;</span>; cin &gt;&gt; data;<br>                cout &lt;&lt; endl;<br>                <br>                <span class="hljs-function">string <span class="hljs-title">input</span><span class="hljs-params">(data)</span></span>;<br>                SHA1 checksum;<br>                checksum.<span class="hljs-built_in">update</span>(input);<br>                <span class="hljs-type">char</span> hash[<span class="hljs-number">41</span>];<br>                <span class="hljs-built_in">strcpy</span>(hash, checksum.<span class="hljs-built_in">final</span>().<span class="hljs-built_in">c_str</span>());<br>                <br>                blo -&gt; BlockArray[i].Data = data;<br>                blo -&gt; BlockArray[i].Number = i+<span class="hljs-number">1</span>;<br>                blo -&gt; BlockArray[i].p_hash = p_hash;<br>                blo -&gt; BlockArray[i].hash = hash;<br>                <br>                p_hash = hash;<br>                blo -&gt; m_Size++; <span class="hljs-comment">// the size of block could plus 1 after adding 1 block.</span><br>            &#125;<br>            cout &lt;&lt; <span class="hljs-string">&quot;You have added &quot;</span> &lt;&lt; addNum &lt;&lt; <span class="hljs-string">&quot; block(s) successfully!!!&quot;</span> &lt;&lt; endl;<br>            <br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Incorrect input!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// First, the second operation checks if there are blocks in it. If the user directly selects this action without entering a new block, the system will display Empty, the system will redisplay the menu and let the user re-enter.</span><br><span class="hljs-comment">// If there is the block(s), the second operation can display the data of the chain in three ways: 1. the user can display the data of the whole chain by entering the block number. 2. the data of the whole chain. 3. the hash value of a specific block.</span><br><span class="hljs-comment">// If the user enters another number, the program will display: &quot;Input wrong or empty information!&quot;. The And then program redisplays the three query methods.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">findBlock</span><span class="hljs-params">(Blockchain * blo)</span></span>&#123;   <span class="hljs-comment">// display the chain data in a number of ways</span><br>                                    <span class="hljs-comment">// by block number</span><br>                                    <span class="hljs-comment">// the data of the whole chain</span><br>                                    <span class="hljs-comment">// the hash values of a particular block</span><br>    <br>  <span class="hljs-comment">// Take case 1 as an example. When the &quot;select&quot; input by the user is 1, execute case 1. Check if the block is not empty, then compare the &quot;Number&quot; stored in the structure with the number that the user wants to find for traversal and comparison. If found, output the information of the entire chain. The program also designs a Boolean variable check, which is used if the data entered by the user matches, if not found, the program outputs &quot;No corresponding block was found!&quot;. And asked to re-enter the numbers. If the data entered when querying the method is incorrect, the function will exit, and the menu will be redisplayed.</span><br>    <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;1.Search by block number&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;2.Search by the data of the whole chain&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;3.Search by the hash values of a particular block&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Please enter the search method: &quot;</span>;<br>        <span class="hljs-type">int</span> select;<br>        <span class="hljs-type">int</span> S_number; <span class="hljs-comment">// initialize the block number that user will input</span><br>        string data;<br>        string hash;<br>        cin &gt;&gt; select;<br>        <span class="hljs-keyword">if</span> (select == <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">// Search by block number</span><br>            cout &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Please enter the block number you are looking for: &quot;</span>;<br>            cin &gt;&gt; S_number; <span class="hljs-comment">// let user input the block number they want to search</span><br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123;<br>                cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// Display the informations of the block that the user wants to see according to the block number entered by the user</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;***************** Here is the information of block &quot;</span> &lt;&lt; S_number &lt;&lt; <span class="hljs-string">&quot; *****************&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tNumber: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].Number &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tData: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].Data &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].hash &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].p_hash &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            cout &lt;&lt; endl;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (select == <span class="hljs-number">2</span>)&#123; <span class="hljs-comment">// Search by the data of the whole chain</span><br>            cout &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Please enter the data of the block you are looking for: &quot;</span>;<br>            cin &gt;&gt; data;<br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// Display the informations of the block that the user wants to see according to the block data entered by the user</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size; i++)&#123;<br>                    <span class="hljs-keyword">if</span> (blo-&gt;BlockArray[i].Data == data) &#123;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;***************** Here is the information of block &quot;</span> &lt;&lt; i+<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&quot; *****************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tNumber: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Number &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tData: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Data &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].p_hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                    &#125;   <br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (select == <span class="hljs-number">3</span>)&#123; <span class="hljs-comment">// Search by the hash values of a particular block</span><br>            cout &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Please enter the hash value of the block you are looking for: &quot;</span>;<br>            cin &gt;&gt; hash;<br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// Display the informations of the block that the user wants to see according to the hash values of a particular block entered by the user</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size; i++)&#123;<br>                    <span class="hljs-keyword">if</span> (blo-&gt;BlockArray[i].hash == hash) &#123;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;***************** Here is the information of block &quot;</span> &lt;&lt; i+<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&quot; *****************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tNumber: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Number &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tData: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Data &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].p_hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                    &#125;<br>                &#125;<br>            &#125;<br>            <br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Input wrong or empty information!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// The third operation checks whether there are blocks in it. If not, the program will display &quot;Empty&quot; and the system will redisplay the menu and ask the user to retype.</span><br><span class="hljs-comment">// This function allows the user to check the integrity of the data stored in the chain. The integrity of the data in the chain is judged by comparing the hash value with the previous hash value. When the blockchain already has block information entered by the user. When the user enters Menu number 3, the program will compare the hash value of each block with the previous hash value. Traverse each block, if the previous hash value of the next one is equal to the previous hash value, output &quot;The blocks are integral&quot;.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Check_integrity</span><span class="hljs-params">(Blockchain * blo)</span></span>&#123; <span class="hljs-comment">// Check the integrity of the data</span><br>    <br>    <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">bool</span> check = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Initialize a Boolean value</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size<span class="hljs-number">-1</span>; i++) &#123; <span class="hljs-comment">// Check all hash values, compare with their previous hash values</span><br>            <span class="hljs-keyword">if</span> (blo-&gt;BlockArray[i+<span class="hljs-number">1</span>].p_hash != blo-&gt;BlockArray[i].hash) &#123;<br>                check = <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        cout &lt;&lt; endl;<br>        <span class="hljs-keyword">if</span> (check) &#123; <span class="hljs-comment">// output the integrity according to the Boolean value</span><br>            cout &lt;&lt; <span class="hljs-string">&quot;\tThe blocks are integral&quot;</span> &lt;&lt; endl;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;\tThe blocks are NOT integral!!!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>        cout &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Below is all hash value of the blockchain: &quot;</span> &lt;&lt; endl; <span class="hljs-comment">// display all the hash values and previous hash values to user for better understanding of the integrity of the blockchain</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size; i++)&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].hash &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].p_hash &lt;&lt; endl;<br>            cout &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// In the code, the program creates the Blockchain structure variable &quot;blo&quot; and initializes the current number of blocks in the Blockchain. Calling the menu guarantees that the menu is available to the user every time. select is the user&#x27;s input to perform the corresponding operation.</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Blockchain blo; <span class="hljs-comment">// naming structure</span><br>    blo.m_Size = <span class="hljs-number">0</span>; <span class="hljs-comment">// Initialize the size of blocks</span><br>    <span class="hljs-type">int</span> select = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-built_in">showMenu</span>();<br>        cout &lt;&lt; <span class="hljs-string">&quot;Enter the number of the Menu number: &quot;</span>; cin &gt;&gt; select;<br>        <span class="hljs-keyword">switch</span> (select) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">addBlocks</span>(&amp;blo); <span class="hljs-comment">// This is the function to add blocks</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-built_in">findBlock</span>(&amp;blo); <span class="hljs-comment">// display the chain data in a number of ways by block number, the data of the whole chain or the hash values of a particular block</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>                <span class="hljs-built_in">Check_integrity</span>(&amp;blo); <span class="hljs-comment">// check the integrity of the blocks</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">// enter 0 to end the program</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;Thank you for using.&quot;</span> &lt;&lt; endl;<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">break</span>;<br>                <br>            <span class="hljs-keyword">default</span>:<br>                cout &lt;&lt; <span class="hljs-string">&quot;Please enter correct a number!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="Multi-thread-Web-Server-Python"><a href="#Multi-thread-Web-Server-Python" class="headerlink" title="Multi-thread Web Server (Python)"></a>Multi-thread Web Server (Python)</h1><p>This is a Python-based web server that is capable of processing HTTP requests from browsers or other clients in a multi-threaded way.</p>
<p>You should first run the program “Server.py” and click on the link on the console. This will navigate to the server’s main menu where you can find links to image files, the “server.txt” log file, modifiable files, and 404 not found. You can click on any link and follow the instructions to access the desired file. If the server hasn’t responded for a while, it may have closed the connection. Please try refreshing and clicking again. After you run it, you can go to the log file to find the request record, including the client address, access time, requested file name and response type for each record.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># import socket, import threading, import os, import time, and from datetime import datetime are Python modules imported at the start of the code. Class Server is defined as the main server class that takes host, port, and html_file parameters in its constructor. It creates a server socket with socket.socket(), sets socket options with setsockopt(), and binds the socket to the host and port with bind(). It then listens for incoming connections with listen().</span><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> http <span class="hljs-keyword">import</span> HTTPStatus<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Server</span>:<br>  <span class="hljs-comment"># __init__: The constructor initializes the server with a specified host and port, and a default html_file to serve when the root directory (&quot;/&quot;) is requested. It also sets up a server socket and binds it to the given address and port.</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, host, port, html_file</span>):<br>        self.host = host<br>        self.port = port<br>        self.html_file = html_file<br>        self.server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>        self.server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number">1</span>)<br>        self.server_socket.bind((self.host, self.port))<br>        self.server_socket.listen()<br><br>    <span class="hljs-comment"># serve_forever: This method starts the server loop, which continuously listens for incoming connections. For each client that connects, it spawns a new thread to handle the client&#x27;s requests, allowing the server to handle multiple clients simultaneously.</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">serve_forever</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Server listening on http://<span class="hljs-subst">&#123;self.host&#125;</span>:<span class="hljs-subst">&#123;self.port&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            client_socket, client_address = self.server_socket.accept()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Accepted connection from <span class="hljs-subst">&#123;client_address&#125;</span>&quot;</span>)<br>            client_thread = threading.Thread(target=self.handle_client, args=(client_socket, client_address))<br>            client_thread.start()<br><br>     <span class="hljs-comment"># handle_client: This method handles a client&#x27;s connection. It reads and parses the client&#x27;s HTTP request, logs the request details, determines what file the client is requesting, and responds appropriately. If the client is requesting a file that exists, it sends the file&#x27;s content with a 200 OK status. If the client is requesting a file that does not exist, it sends a 404 Not Found status. If the client is making a conditional GET request with an If-Modified-Since header, and the requested file has not been modified since the specified date, it sends a 304 Not Modified status.</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_client</span>(<span class="hljs-params">self, client_socket, client_address</span>):<br>        <span class="hljs-keyword">with</span> client_socket:<br>            request = client_socket.recv(<span class="hljs-number">1024</span>).decode()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Received request from <span class="hljs-subst">&#123;client_address&#125;</span>:&quot;</span>)<br>            <span class="hljs-built_in">print</span>(request)<br><br>            <span class="hljs-comment"># Parse the request to determine the specific file being requested</span><br>            headers = request.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            filename = headers[<span class="hljs-number">0</span>].split()[<span class="hljs-number">1</span>]  <span class="hljs-comment"># /</span><br>            method = headers[<span class="hljs-number">0</span>].split()[<span class="hljs-number">0</span>]  <span class="hljs-comment"># Get, Head</span><br><br>            <span class="hljs-comment"># Add logging here</span><br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;server.txt&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>, mode=<span class="hljs-string">&quot;a&quot;</span>) <span class="hljs-keyword">as</span> log_file:<br>                <span class="hljs-keyword">if</span> filename == <span class="hljs-string">&quot;/&quot;</span>:<br>                    log_message = <span class="hljs-string">f&quot;Client address: [<span class="hljs-subst">&#123;client_address[<span class="hljs-number">0</span>]&#125;</span>]\tAccess time: [<span class="hljs-subst">&#123;datetime.now()&#125;</span>]\nFile name: [<span class="hljs-subst">&#123;filename&#125;</span>index.html]\tResponse type: [<span class="hljs-subst">&#123;method&#125;</span> HTTP/1.1 200 OK]\n\n&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    log_message = <span class="hljs-string">f&quot;Client address: [<span class="hljs-subst">&#123;client_address[<span class="hljs-number">0</span>]&#125;</span>]\tAccess time: [<span class="hljs-subst">&#123;datetime.now()&#125;</span>]\nFile name: [<span class="hljs-subst">&#123;filename&#125;</span>]\tResponse type: [<span class="hljs-subst">&#123;method&#125;</span> HTTP/1.1 200 OK]\n\n&quot;</span><br>                log_file.write(log_message)<br><br>            <span class="hljs-keyword">if</span> method == <span class="hljs-string">&#x27;GET&#x27;</span> <span class="hljs-keyword">or</span> method == <span class="hljs-string">&#x27;HEAD&#x27;</span>:<br>              <span class="hljs-comment"># If the method is GET or HEAD, it attempts to retrieve the requested file and sends a response back to the client with the file contents and appropriate headers. Since image files are binary and must be viewed in &quot;rb&quot; mode before being transferred individually, they cannot be read and delivered to the browser immediately. In this manner, the picture returned by the GET request may be seen normally in the browser. If the file has not been updated after being cached by the browser, it will return 304 Not Modified when we reload the website. This indicates that our software can appropriately handle image files and 304 answers. If the file does not exist, it sends a 404 Not Found error. If the file is a directory, it attempts to append index.html to the file path and retrieve that file. </span><br>                <span class="hljs-keyword">if</span> filename == <span class="hljs-string">&#x27;/&#x27;</span>:<br>                    path = self.html_file<br>                <span class="hljs-keyword">else</span>:<br>                    path = filename[<span class="hljs-number">1</span>:]<br><br>                filepath = os.path.join(os.getcwd(), path)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(filepath):<br>                    self.send_error(client_socket, HTTPStatus.NOT_FOUND)<br>                    <span class="hljs-keyword">return</span><br><br>                <span class="hljs-keyword">if</span> os.path.isdir(filepath):<br>                    filepath = os.path.join(filepath, self.html_file)<br><br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                        content = f.read()<br>                        content_length = <span class="hljs-built_in">len</span>(content)<br>                        last_modified = datetime.utcfromtimestamp(os.path.getmtime(filepath)).strftime(<br>                            <span class="hljs-string">&#x27;%a, %d %b %Y %H:%M:%S GMT&#x27;</span>)<br>                        <span class="hljs-comment"># Check for If-Modified-Since header</span><br>                        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;If-Modified-Since&#x27;</span> <span class="hljs-keyword">in</span> request:<br>                            ims = headers[headers.index(<span class="hljs-string">&#x27;If-Modified-Since: &#x27;</span>) + <span class="hljs-number">1</span>].strip()<br>                            ims_time = datetime.strptime(ims, <span class="hljs-string">&#x27;%a, %d %b %Y %H:%M:%S GMT&#x27;</span>)<br>                            <span class="hljs-keyword">if</span> ims_time &gt;= datetime.utcfromtimestamp(os.path.getmtime(filepath)):<br>                                self.send_error(client_socket, HTTPStatus.NOT_MODIFIED) <span class="hljs-comment"># 304 Not Modified</span><br>                                <span class="hljs-keyword">return</span><br>                        <span class="hljs-comment"># Get Response Headers</span><br>                        response_headers = [<br>                            <span class="hljs-string">f&quot;HTTP/1.1 <span class="hljs-subst">&#123;HTTPStatus.OK.value&#125;</span> <span class="hljs-subst">&#123;HTTPStatus.OK.phrase&#125;</span>&quot;</span>,<br>                            <span class="hljs-string">f&quot;Content-Length: <span class="hljs-subst">&#123;content_length&#125;</span>&quot;</span>,<br>                            <span class="hljs-string">f&quot;Last-Modified: <span class="hljs-subst">&#123;last_modified&#125;</span>&quot;</span>,<br>                            <span class="hljs-string">&quot;Connection: keep-alive&quot;</span>,<br>                        ]<br>                        response = <span class="hljs-string">&#x27;\r\n&#x27;</span>.join(response_headers).encode() + <span class="hljs-string">b&#x27;\r\n\r\n&#x27;</span><br>                    <span class="hljs-keyword">if</span> method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>                        response += content<br>                    client_socket.sendall(response)<br>                <span class="hljs-keyword">except</span>:<br>                    self.send_error(client_socket, HTTPStatus.NOT_FOUND) <span class="hljs-comment"># 404 File Not Found</span><br>                    <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_error</span>(<span class="hljs-params">self, client_socket, status</span>): <span class="hljs-comment"># sends an error response to the client with the specified HTTP status.</span><br>        response = <span class="hljs-string">f&quot;HTTP/1.1 <span class="hljs-subst">&#123;status.value&#125;</span> <span class="hljs-subst">&#123;status.phrase&#125;</span>\r\nConnection: close\r\n\r\n&quot;</span><br>        client_socket.sendall(response.encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(): <span class="hljs-comment"># main() creates a new instance of the Server class with a host of 127.0.0.1, port 8000, and the HTML file web.html. It then calls serve_forever() on this instance, which starts the server and listens for incoming connections.</span><br>    server = Server(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">8000</span>, html_file=<span class="hljs-string">&#x27;web.html&#x27;</span>)<br>    server.serve_forever()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<ol>
<li>The <code>main</code> function creates an instance of the <code>Server</code> class with the host <code>127.0.0.1</code> (localhost), the port <code>8000</code>, and the default HTML file <code>web.html</code>, and starts the server.</li>
<li>The <code>if __name__ == &#39;__main__&#39;</code> conditional checks whether the script is being executed directly (rather than being imported as a module), and if so, it calls the <code>main</code> function to start the server.</li>
<li>The code creates a multithreaded HTTP server in Python with sockets and threading. It listens on a given IP address and port and handles requests from clients. It sends static files from the local file system for HTTP GET requests and returns suitable HTTP status codes. It writes client requests to a file called “server.txt” in UTF-8. The code has a class named Server with three methods: <strong>init</strong>(), serve_forever(), and handle_client(). The <strong>init</strong>() method sets up the server TCP socket and binds it to the IP address and port. The serve_forever() method waits for client connections and launches a new thread for each one. The handle_client() method gets and parses the client request, reads the file from the local file system, and sends a response to the client. The main() function makes a Server object and starts serving requests.</li>
</ol>
<h1 id="Command-line-based-Personal-Information-Manager-Java"><a href="#Command-line-based-Personal-Information-Manager-Java" class="headerlink" title="Command-line-based Personal Information Manager (Java)"></a>Command-line-based Personal Information Manager (Java)</h1><h2 id="View-Main-method"><a href="#View-Main-method" class="headerlink" title="View - Main method"></a>View - Main method</h2><p><code>Main</code> 类中的 <code>main</code> 方法是应用程序的入口点。它首先尝试从一个文件中加载数据。如果数据成功加载，程序进入一个循环，它等待用户输入并处理命令。</p>
<p>每个命令都表示为一个字符串。程序使用 <code>if</code> 和 <code>else if</code> 语句来确定用户输入了哪个命令。根据命令的不同，调用不同的方法来处理命令。例如，如果用户输入一个以 “note “ 开头的命令，将调用 <code>NoteController.executeCommand(sc, command)</code> 方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim;<br><br><span class="hljs-keyword">import</span> info.pim.constant.Message;<br><span class="hljs-keyword">import</span> info.pim.controller.*;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">imDataFilePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span> (args.length &gt; <span class="hljs-number">0</span>) &#123;<br>            imDataFilePath = args[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">loaded</span> <span class="hljs-operator">=</span> PimDataService.loadPimData(imDataFilePath);<br>        <span class="hljs-keyword">if</span> (!loaded) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        showCommand();<br>        <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) &#123;<br>            System.out.println();<br>            System.out.println(<span class="hljs-string">&quot;----------------------------------------------------------------------&quot;</span>);<br>            printCommand(<span class="hljs-string">&quot;help&quot;</span>, <span class="hljs-string">&quot;指令清单&quot;</span>);<br>            printCommand(<span class="hljs-string">&quot;quit&quot;</span>, <span class="hljs-string">&quot;退出PIM&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;请输入操作指令：&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">command</span> <span class="hljs-operator">=</span> sc.nextLine();<br><br>            <span class="hljs-keyword">if</span> (command.equals(<span class="hljs-string">&quot;quit&quot;</span>)) &#123;<br>                System.exit(<span class="hljs-number">0</span>);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.equals(<span class="hljs-string">&quot;help&quot;</span>)) &#123;<br>                showCommand();<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.startsWith(<span class="hljs-string">&quot;note &quot;</span>)) &#123;<br>                NoteController.executeCommand(sc, command);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.startsWith(<span class="hljs-string">&quot;task &quot;</span>)) &#123;<br>                TaskController.executeCommand(sc, command);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.startsWith(<span class="hljs-string">&quot;event &quot;</span>)) &#123;<br>                EventController.executeCommand(sc, command);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.startsWith(<span class="hljs-string">&quot;contact &quot;</span>)) &#123;<br>                ContactController.executeCommand(sc, command);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.trim().startsWith(<span class="hljs-string">&quot;search&quot;</span>)) &#123;<br>                SearchController.executeCommand(sc, command);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (command.trim().startsWith(<span class="hljs-string">&quot;print&quot;</span>)) &#123;<br>                PrintController.executeCommand(sc, command);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showCommand</span><span class="hljs-params">()</span> &#123;<br>        System.out.println();<br>        System.out.println(Message.WELCOME);<br><br>        printCommand(<span class="hljs-string">&quot;note&quot;</span>, <span class="hljs-string">&quot;list&quot;</span>, <span class="hljs-string">&quot;列表note&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;note&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;新增note&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;note&quot;</span>, <span class="hljs-string">&quot;edit [id]&quot;</span>, <span class="hljs-string">&quot;编辑note&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;note&quot;</span>, <span class="hljs-string">&quot;delete [id]&quot;</span>, <span class="hljs-string">&quot;删除note&quot;</span>);<br><br>        printCommand(<span class="hljs-string">&quot;task&quot;</span>, <span class="hljs-string">&quot;list&quot;</span>, <span class="hljs-string">&quot;列表task&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;task&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;新增task&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;task&quot;</span>, <span class="hljs-string">&quot;edit [id]&quot;</span>, <span class="hljs-string">&quot;编辑task&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;task&quot;</span>, <span class="hljs-string">&quot;delete [id]&quot;</span>, <span class="hljs-string">&quot;删除task&quot;</span>);<br><br>        printCommand(<span class="hljs-string">&quot;event&quot;</span>, <span class="hljs-string">&quot;list&quot;</span>, <span class="hljs-string">&quot;列表event&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;event&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;新增event&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;event&quot;</span>, <span class="hljs-string">&quot;edit [id]&quot;</span>, <span class="hljs-string">&quot;编辑event&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;event&quot;</span>, <span class="hljs-string">&quot;delete [id]&quot;</span>, <span class="hljs-string">&quot;删除event&quot;</span>);<br><br>        printCommand(<span class="hljs-string">&quot;contact&quot;</span>, <span class="hljs-string">&quot;list&quot;</span>, <span class="hljs-string">&quot;列表contact&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;contact&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;新增contact&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;contact&quot;</span>, <span class="hljs-string">&quot;edit [id]&quot;</span>, <span class="hljs-string">&quot;编辑contact&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;contact&quot;</span>, <span class="hljs-string">&quot;delete [id]&quot;</span>, <span class="hljs-string">&quot;删除contact&quot;</span>);<br><br>        printCommand(<span class="hljs-string">&quot;search&quot;</span>, <span class="hljs-string">&quot;[type|text|time]&quot;</span>, <span class="hljs-string">&quot;查询&quot;</span>);<br>        printCommand(<span class="hljs-string">&quot;print&quot;</span>, <span class="hljs-string">&quot;[id|all]&quot;</span>, <span class="hljs-string">&quot;输出&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printCommand</span><span class="hljs-params">(String command, String subCommand, String desc)</span> &#123;<br>        System.out.printf(<span class="hljs-string">&quot;%-15s %-30s %-25s&quot;</span>, command, subCommand, desc);<br>        System.out.println();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printCommand</span><span class="hljs-params">(String command, String desc)</span> &#123;<br>        System.out.printf(<span class="hljs-string">&quot;%-15s %-30s&quot;</span>, command, desc);<br>        System.out.println();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Service-package"><a href="#Service-package" class="headerlink" title="Service package"></a>Service package</h2><p><code>info.pim.service</code> 包含了 <code>PimDataService</code> 类，该类提供了管理便签，任务，事件，和联系人的方法。它从文件加载和存储数据。</p>
<h3 id="Class-PimDataService"><a href="#Class-PimDataService" class="headerlink" title="Class PimDataService"></a>Class PimDataService</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 这个Java类PimDataService充当个人信息管理器(PIM)应用程序的服务类。它处理从文件读取和写入数据 (reading and writing of data from/to a file)，并提供管理笔记、任务、事件和联系人的方法 (methods for managing notes, tasks, events, and contacts).</span><br><span class="hljs-keyword">package</span> info.pim.service;<br><br><span class="hljs-keyword">import</span> info.pim.model.Contact;<br><span class="hljs-keyword">import</span> info.pim.model.Event;<br><span class="hljs-keyword">import</span> info.pim.model.Note;<br><span class="hljs-keyword">import</span> info.pim.model.Task;<br><span class="hljs-keyword">import</span> info.pim.util.SnowflakeIdWorker;<br><span class="hljs-keyword">import</span> info.pim.util.StringUtils;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Optional;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * PIM数据服务</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PimDataService</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * pim数据存储的文件路径</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">imDataFilePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;data&quot;</span> + File.separator + <span class="hljs-string">&quot;data.pim&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Note&gt; notes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Task&gt; tasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Event&gt; events = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Contact&gt; contacts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">SnowflakeIdWorker</span> <span class="hljs-variable">idWorker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SnowflakeIdWorker</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 从文件中加载PIM数据</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> path 如果为空，则从默认位置data/data.pim加载</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">loadPimData</span><span class="hljs-params">(String path)</span> &#123;<br>        <span class="hljs-keyword">if</span> (!StringUtils.isEmpty(path)) &#123; <span class="hljs-comment">// path 如果不为空，直接从文件中加载PIM数据</span><br>            imDataFilePath = path;<br>        &#125;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">File</span> <span class="hljs-variable">pimFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imDataFilePath); <span class="hljs-comment">// path 如果为空，则从默认位置data/data.pim加载</span><br><br>            <span class="hljs-keyword">if</span> (!pimFile.exists()) &#123;<br>                <span class="hljs-keyword">if</span> (!pimFile.getParentFile().exists()) &#123; <span class="hljs-comment">// 这段代码首先检查父目录是否存在，如果不存在则创建。然后在该路径下创建新的文件。如果文件是新创建的（也就是空文件），那么调用 savePimData() 方法来初始化数据。</span><br>                    pimFile.getParentFile().mkdirs();<br>                &#125;<br>                pimFile.createNewFile();<br>                <span class="hljs-comment">// 空文件时初始化数据结构</span><br>                savePimData();<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-comment">// 创建 FileInputStream 和 ObjectInputStream 来从文件中读取对象，然后数据被反序列化为包含不同类型的PIM数据（笔记，任务，事件，联系人）的HashMap。</span><br>                <span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>                <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">ois</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>                fis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(pimFile);<br>                ois = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(fis);<br>                HashMap&lt;String, List&gt; map = (HashMap&lt;String, List&gt;) ois.readObject(); <br>              <span class="hljs-comment">// 然后，将读取的对象强制转换为 HashMap&lt;String, List&gt;</span><br>              <br>                <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) &#123; <br>                  <span class="hljs-comment">// 如果读取到的 map 不为 null，那么将 map 中对应的列表赋值给类变量 notes, tasks, events, contacts。</span><br>                    notes = map.getOrDefault(<span class="hljs-string">&quot;notes&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>());<br>                    tasks = map.getOrDefault(<span class="hljs-string">&quot;tasks&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>());<br>                    events = map.getOrDefault(<span class="hljs-string">&quot;events&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>());<br>                    contacts = map.getOrDefault(<span class="hljs-string">&quot;contacts&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>());<br>                &#125;<br>                ois.close();<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>            System.out.println(<span class="hljs-string">&quot;加载PIM数据出错！&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存PIM数据到文件中</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">savePimData</span><span class="hljs-params">()</span> &#123;<br>        HashMap&lt;String, List&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        map.put(<span class="hljs-string">&quot;notes&quot;</span>, notes);<br>        map.put(<span class="hljs-string">&quot;tasks&quot;</span>, tasks);<br>        map.put(<span class="hljs-string">&quot;events&quot;</span>, events);<br>        map.put(<span class="hljs-string">&quot;contacts&quot;</span>, contacts);<br><br>        <span class="hljs-type">File</span> <span class="hljs-variable">pimFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imDataFilePath);<br>        <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            fos = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(pimFile);<br>            <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(fos);<br>            oos.writeObject(map);<br>            oos.close();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>            System.out.println(<span class="hljs-string">&quot;保存PIM数据出错！&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据id获取Note</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Note <span class="hljs-title function_">getNote</span><span class="hljs-params">(String id)</span> &#123;<br>        Optional&lt;Note&gt; optionalNote = notes.stream().filter(f -&gt; f.getId().equals(id)).findFirst();<br>        <span class="hljs-keyword">return</span> optionalNote.orElse(<span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存Note</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveNote</span><span class="hljs-params">(Note note)</span> &#123;<br>        Optional&lt;Note&gt; optionalNote = notes.stream().filter(f -&gt; f.getId().equals(note.getId())).findFirst();<br>        <span class="hljs-keyword">if</span> (optionalNote.isPresent()) &#123;<br>            <span class="hljs-type">Note</span> <span class="hljs-variable">noteUpdate</span> <span class="hljs-operator">=</span> optionalNote.get();<br>            <span class="hljs-comment">// 更新数据</span><br>            noteUpdate.copyData(note);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 新增数据</span><br>            notes.add(note);<br>        &#125;<br>        savePimData();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除Note</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id 待删除的 id</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteNote</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; notes.size(); i++) &#123;<br>            <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> notes.get(i);<br>            <span class="hljs-keyword">if</span> (note.getId().equals(id)) &#123;<br>                notes.remove(i);<br>                savePimData();<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据id获取Task</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Task <span class="hljs-title function_">getTask</span><span class="hljs-params">(String id)</span> &#123;<br>        Optional&lt;Task&gt; optionalTask = tasks.stream().filter(f -&gt; f.getId().equals(id)).findFirst();<br>        <span class="hljs-keyword">return</span> optionalTask.orElse(<span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存Task</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveTask</span><span class="hljs-params">(Task task)</span> &#123;<br>        Optional&lt;Task&gt; optionalTask = tasks.stream().filter(f -&gt; f.getId().equals(task.getId())).findFirst();<br>        <span class="hljs-keyword">if</span> (optionalTask.isPresent()) &#123;<br>            <span class="hljs-type">Task</span> <span class="hljs-variable">taskUpdate</span> <span class="hljs-operator">=</span> optionalTask.get();<br>            <span class="hljs-comment">// 更新数据</span><br>            taskUpdate.copyData(task);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 新增数据</span><br>            tasks.add(task);<br>        &#125;<br>        savePimData();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除Task</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id 待删除的 id</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteTask</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tasks.size(); i++) &#123;<br>            <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> tasks.get(i);<br>            <span class="hljs-keyword">if</span> (task.getId().equals(id)) &#123;<br>                tasks.remove(i);<br>                savePimData();<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据id获取Event</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Event <span class="hljs-title function_">getEvent</span><span class="hljs-params">(String id)</span> &#123;<br>        Optional&lt;Event&gt; optionalEvent = events.stream().filter(f -&gt; f.getId().equals(id)).findFirst();<br>        <span class="hljs-keyword">return</span> optionalEvent.orElse(<span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存Event</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveEvent</span><span class="hljs-params">(Event event)</span> &#123;<br>        Optional&lt;Event&gt; optionalEvent = events.stream().filter(f -&gt; f.getId().equals(event.getId())).findFirst();<br>        <span class="hljs-keyword">if</span> (optionalEvent.isPresent()) &#123;<br>            <span class="hljs-type">Event</span> <span class="hljs-variable">eventUpdate</span> <span class="hljs-operator">=</span> optionalEvent.get();<br>            <span class="hljs-comment">// 更新数据</span><br>            eventUpdate.copyData(event);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 新增数据</span><br>            events.add(event);<br>        &#125;<br>        savePimData();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除Event</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id 待删除的 id</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEvent</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; events.size(); i++) &#123;<br>            <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> events.get(i);<br>            <span class="hljs-keyword">if</span> (event.getId().equals(id)) &#123;<br>                events.remove(i);<br>                savePimData();<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据id获取Contact</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Contact <span class="hljs-title function_">getContact</span><span class="hljs-params">(String id)</span> &#123;<br>        Optional&lt;Contact&gt; optionalContact = contacts.stream().filter(f -&gt; f.getId().equals(id)).findFirst();<br>        <span class="hljs-keyword">return</span> optionalContact.orElse(<span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存Contact</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveContact</span><span class="hljs-params">(Contact contact)</span> &#123;<br>        Optional&lt;Contact&gt; optionalContact = contacts.stream().filter(f -&gt; f.getId().equals(contact.getId())).findFirst();<br>        <span class="hljs-keyword">if</span> (optionalContact.isPresent()) &#123;<br>            <span class="hljs-type">Contact</span> <span class="hljs-variable">contactUpdate</span> <span class="hljs-operator">=</span> optionalContact.get();<br>            <span class="hljs-comment">// 更新数据</span><br>            contactUpdate.copyData(contact);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 新增数据</span><br>            contacts.add(contact);<br>        &#125;<br>        savePimData();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除Contact</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id 待删除的 id</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteContact</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; contacts.size(); i++) &#123;<br>            <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> contacts.get(i);<br>            <span class="hljs-keyword">if</span> (contact.getId().equals(id)) &#123;<br>                contacts.remove(i);<br>                savePimData();<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 获取所有数据</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Object&gt; <span class="hljs-title function_">getAllPir</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Object&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        result.addAll(notes);<br>        result.addAll(tasks);<br>        result.addAll(events);<br>        result.addAll(contacts);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据id获取</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">getPirById</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> getNote(id);<br>        <span class="hljs-keyword">if</span> (note != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> note;<br>        &#125;<br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> getTask(id);<br>        <span class="hljs-keyword">if</span> (task != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> task;<br>        &#125;<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> getEvent(id);<br>        <span class="hljs-keyword">if</span> (event != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> event;<br>        &#125;<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> getContact(id);<br>        <span class="hljs-keyword">if</span> (contact != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> contact;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><p><code>info.pim.model</code> 包含四个类：<code>Contact</code>，<code>Event</code>，<code>Note</code>，和 <code>Task</code>。每个类代表了 PIM 可以管理的不同类型的数据。这些类实现了 <code>Serializable</code> 接口，这允许它们被写入文件和从文件中读取。</p>
<h3 id="Class-Contact"><a href="#Class-Contact" class="headerlink" title="Class Contact"></a>Class Contact</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.model;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 联系人模型</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Contact</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 唯一标识</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 姓名</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 地址</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String address;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 手机</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String mobile;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">copyData</span><span class="hljs-params">(Contact source)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = source.name;<br>        <span class="hljs-built_in">this</span>.address = source.address;<br>        <span class="hljs-built_in">this</span>.mobile = source.mobile;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAddress</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> address;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAddress</span><span class="hljs-params">(String address)</span> &#123;<br>        <span class="hljs-built_in">this</span>.address = address;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMobile</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> mobile;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMobile</span><span class="hljs-params">(String mobile)</span> &#123;<br>        <span class="hljs-built_in">this</span>.mobile = mobile;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Contact&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, address=&#x27;&quot;</span> + address + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, mobile=&#x27;&quot;</span> + mobile + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Class-Event"><a href="#Class-Event" class="headerlink" title="Class Event"></a>Class Event</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.model;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 事件模型</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Event</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 唯一标识</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 开始日期</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String startTime;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 警告信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String alarm;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 描述</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String description;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">copyData</span><span class="hljs-params">(Event source)</span> &#123;<br>        <span class="hljs-built_in">this</span>.startTime = source.startTime;<br>        <span class="hljs-built_in">this</span>.alarm = source.alarm;<br>        <span class="hljs-built_in">this</span>.description = source.description;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getStartTime</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> startTime;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setStartTime</span><span class="hljs-params">(String startTime)</span> &#123;<br>        <span class="hljs-built_in">this</span>.startTime = startTime;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAlarm</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> alarm;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAlarm</span><span class="hljs-params">(String alarm)</span> &#123;<br>        <span class="hljs-built_in">this</span>.alarm = alarm;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> description;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDescription</span><span class="hljs-params">(String description)</span> &#123;<br>        <span class="hljs-built_in">this</span>.description = description;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Event&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, startTime=&#x27;&quot;</span> + startTime + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, alarm=&#x27;&quot;</span> + alarm + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, description=&#x27;&quot;</span> + description + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="Class-Note"><a href="#Class-Note" class="headerlink" title="Class Note"></a>Class Note</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.model;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 笔记模型</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Note</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 唯一标识</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 笔记内容</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String content;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">copyData</span><span class="hljs-params">(Note source)</span> &#123;<br>        <span class="hljs-built_in">this</span>.content = source.content;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getContent</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> content;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setContent</span><span class="hljs-params">(String content)</span> &#123;<br>        <span class="hljs-built_in">this</span>.content = content;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Note&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, content=&#x27;&quot;</span> + content + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Class-Task"><a href="#Class-Task" class="headerlink" title="Class Task"></a>Class Task</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.model;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 任务模型</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 唯一标识</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 截止日期</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String deadline;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 描述</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String description;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">copyData</span><span class="hljs-params">(Task source)</span> &#123;<br>        <span class="hljs-built_in">this</span>.deadline = source.deadline;<br>        <span class="hljs-built_in">this</span>.description = source.description;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDeadline</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> deadline;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDeadline</span><span class="hljs-params">(String deadline)</span> &#123;<br>        <span class="hljs-built_in">this</span>.deadline = deadline;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> description;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDescription</span><span class="hljs-params">(String description)</span> &#123;<br>        <span class="hljs-built_in">this</span>.description = description;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Task&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, deadline=&#x27;&quot;</span> + deadline + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, description=&#x27;&quot;</span> + description + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h2><p><code>info.pim.controller</code> 包含各种控制器类，包括 <code>ContactController</code>，<code>EventController</code>，<code>NoteController</code>，<code>PrintController</code>，<code>SearchController</code>，和 <code>TaskController</code>。这些类包含处理与管理便签，任务，事件，和联系人相关的特定命令的方法。</p>
<h3 id="Class-ContactController"><a href="#Class-ContactController" class="headerlink" title="Class ContactController"></a>Class ContactController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.controller;<br><br><span class="hljs-keyword">import</span> info.pim.model.Contact;<br><span class="hljs-keyword">import</span> info.pim.model.Task;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Contact Controller</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContactController</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(Scanner sc, String command)</span> &#123;<br>        String[] commands = command.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">if</span> (commands.length &gt;= <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;list&quot;</span>)) &#123;<br>                list();<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;add&quot;</span>)) &#123;<br>                add(sc);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;edit&quot;</span>)) &#123;<br>                edit(sc, commands);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;delete&quot;</span>)) &#123;<br>                delete(commands);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 列表查询</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">list</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Contact&gt; contacts = PimDataService.contacts;<br>        System.out.println(<span class="hljs-string">&quot;contact list:&quot;</span>);<br>        <span class="hljs-keyword">for</span> (Contact contact : contacts) &#123;<br>            System.out.println(contact);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 添加</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Scanner sc)</span> &#123;<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>();<br>        contact.setId(PimDataService.idWorker.nextId());<br><br>        updateData(sc, contact);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 编辑</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">edit</span><span class="hljs-params">(Scanner sc, String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行edit指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> PimDataService.getContact(id);<br>        <span class="hljs-keyword">if</span> (contact == <span class="hljs-literal">null</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;指定的contact不存在！&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        updateData(sc, contact);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateData</span><span class="hljs-params">(Scanner sc, Contact contact)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;请输入name：&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        contact.setName(name);<br>        System.out.println(<span class="hljs-string">&quot;请输入address：&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">address</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        contact.setAddress(address);<br>        System.out.println(<span class="hljs-string">&quot;请输入mobile：&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">mobile</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        contact.setMobile(mobile);<br>        PimDataService.saveContact(contact);<br>        System.out.println(<span class="hljs-string">&quot;保存成功！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行delete指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        PimDataService.deleteContact(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Class-EventController"><a href="#Class-EventController" class="headerlink" title="Class EventController"></a>Class EventController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.controller;<br><br><span class="hljs-keyword">import</span> info.pim.model.Event;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Event Controller</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventController</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(Scanner sc, String command)</span> &#123;<br>        String[] commands = command.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">if</span> (commands.length &gt;= <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;list&quot;</span>)) &#123;<br>                list();<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;add&quot;</span>)) &#123;<br>                add(sc);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;edit&quot;</span>)) &#123;<br>                edit(sc, commands);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;delete&quot;</span>)) &#123;<br>                delete(commands);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 列表查询</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">list</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Event&gt; events = PimDataService.events;<br>        System.out.println(<span class="hljs-string">&quot;event list:&quot;</span>);<br>        <span class="hljs-keyword">for</span> (Event event : events) &#123;<br>            System.out.println(event);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 添加</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Scanner sc)</span> &#123;<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>();<br>        event.setId(PimDataService.idWorker.nextId());<br><br>        updateData(sc, event);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 编辑</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">edit</span><span class="hljs-params">(Scanner sc, String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行edit指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> PimDataService.getEvent(id);<br>        <span class="hljs-keyword">if</span> (event == <span class="hljs-literal">null</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;指定的event不存在！&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        updateData(sc, event);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateData</span><span class="hljs-params">(Scanner sc, Event event)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;请输入startTime(格式为yyyy-MM-dd， 例如 2023-10-27)：&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        event.setStartTime(startTime);<br>        System.out.println(<span class="hljs-string">&quot;请输入alarm(格式为yyyy-MM-dd， 例如 2023-10-27)：&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">alarm</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        event.setAlarm(alarm);<br>        System.out.println(<span class="hljs-string">&quot;请输入description(当一行输入为[:quit]退出输入操作)：&quot;</span>);<br>        <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">sbDescription</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">description</span> <span class="hljs-operator">=</span> sc.nextLine();<br>            <span class="hljs-keyword">if</span> (description.equals(<span class="hljs-string">&quot;:quit&quot;</span>)) &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            sbDescription.append(description);<br>        &#125;<br>        event.setDescription(sbDescription.toString());<br>        PimDataService.saveEvent(event);<br>        System.out.println(<span class="hljs-string">&quot;保存成功！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行delete指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        PimDataService.deleteEvent(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Class-NoteController"><a href="#Class-NoteController" class="headerlink" title="Class NoteController"></a>Class NoteController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.controller;<br><br><span class="hljs-keyword">import</span> info.pim.model.Note;<br><span class="hljs-keyword">import</span> info.pim.model.Task;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Note Controller</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NoteController</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(Scanner sc, String command)</span> &#123;<br>        String[] commands = command.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">if</span> (commands.length &gt;= <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;list&quot;</span>)) &#123;<br>                list();<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;add&quot;</span>)) &#123;<br>                add(sc);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;edit&quot;</span>)) &#123;<br>                edit(sc, commands);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;delete&quot;</span>)) &#123;<br>                delete(commands);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 列表查询</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">list</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Note&gt; notes = PimDataService.notes;<br>        System.out.println(<span class="hljs-string">&quot;note list:&quot;</span>);<br>        <span class="hljs-keyword">for</span> (Note note : notes) &#123;<br>            System.out.println(note);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 添加</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Scanner sc)</span> &#123;<br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Note</span>();<br>        note.setId(PimDataService.idWorker.nextId());<br><br>        updateData(sc, note);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 编辑</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">edit</span><span class="hljs-params">(Scanner sc, String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行edit指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> PimDataService.getNote(id);<br>        <span class="hljs-keyword">if</span> (note == <span class="hljs-literal">null</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;指定的note不存在！&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        updateData(sc, note);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateData</span><span class="hljs-params">(Scanner sc, Note note)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;请输入content(当一行输入为[:quit]退出输入操作)：&quot;</span>);<br>        <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">sbContent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> sc.nextLine();<br>            <span class="hljs-keyword">if</span> (content.equals(<span class="hljs-string">&quot;:quit&quot;</span>)) &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            sbContent.append(content);<br>        &#125;<br>        note.setContent(sbContent.toString());<br>        PimDataService.saveNote(note);<br>        System.out.println(<span class="hljs-string">&quot;保存成功！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行delete指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        PimDataService.deleteNote(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Class PrintController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.controller;<br><br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Print Controller</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrintController</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(Scanner sc, String command)</span> &#123;<br>        String[] commands = command.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">if</span> (commands.length &gt;= <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-comment">// 第二个指令作为查询的id</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">1</span>].trim();<br>            <span class="hljs-keyword">if</span> (id.equals(<span class="hljs-string">&quot;all&quot;</span>)) &#123;<br>                List&lt;Object&gt; result = PimDataService.getAllPir();<br>                <span class="hljs-keyword">for</span> (Object pir : result) &#123;<br>                    System.out.println(pir);<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-type">Object</span> <span class="hljs-variable">pir</span> <span class="hljs-operator">=</span> PimDataService.getPirById(id);<br>                <span class="hljs-keyword">if</span> (pir != <span class="hljs-literal">null</span>) &#123;<br>                    System.out.println(pir);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Class-SearchController"><a href="#Class-SearchController" class="headerlink" title="Class SearchController"></a>Class SearchController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.controller;<br><br><span class="hljs-keyword">import</span> info.pim.model.Contact;<br><span class="hljs-keyword">import</span> info.pim.model.Event;<br><span class="hljs-keyword">import</span> info.pim.model.Note;<br><span class="hljs-keyword">import</span> info.pim.model.Task;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><span class="hljs-keyword">import</span> info.pim.util.StringUtils;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Search Controller</span><br><span class="hljs-comment"> * 查询条件的逻辑处理</span><br><span class="hljs-comment"> * 查询命令格式 search + 空格 + 可选的条件</span><br><span class="hljs-comment"> * 可选的条件 type | text | time，并且组合的条件必须按照此顺序</span><br><span class="hljs-comment">     * 条件的值前可加!，代表取反操作</span><br><span class="hljs-comment"> * 多条件之间可使用 &amp;&amp; 或者 ||</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SearchController</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(Scanner sc, String command)</span> &#123;<br>        List&lt;Object&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        String[] commands = command.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">if</span> (commands.length &gt;= <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">if</span> (!commands[<span class="hljs-number">1</span>].startsWith(<span class="hljs-string">&quot;type=&quot;</span>)  &amp;&amp; !commands[<span class="hljs-number">1</span>].startsWith(<span class="hljs-string">&quot;text=&quot;</span>) &amp;&amp; !commands[<span class="hljs-number">1</span>].startsWith(<span class="hljs-string">&quot;time&quot;</span>)) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-comment">// 当前搜索的数据类型条件</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">typeValue</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>            <span class="hljs-comment">// 标记type是否为取反查询</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">typeNegation</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 当前搜索的文本条件</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">textValue</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>            <span class="hljs-comment">// 标记text是否为取反查询</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">textNegation</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 标记text条件和前序条件（如果有为type）是否为and关系</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">textAnd</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 标记text条件和前序条件（如果有为type）是否为or关系</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">textOr</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 当前搜索的时间条件</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">timeValue</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>            <span class="hljs-comment">// 标记time是否为取反查询</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">timeNegation</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 标记time条件和前序条件（如果有为type，text）是否为and关系</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">timeAnd</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 标记time条件和前序条件（如果有为type，text）是否为or关系</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">timeOr</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; commands.length; i++) &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> commands[i];<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">negation</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">if</span> (condition.startsWith(<span class="hljs-string">&quot;type=&quot;</span>)) &#123;<br>                    condition = condition.replace(<span class="hljs-string">&quot;type=&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).trim();<br>                    <span class="hljs-keyword">if</span> (condition.startsWith(<span class="hljs-string">&quot;!&quot;</span>)) &#123;<br>                        negation = <span class="hljs-literal">true</span>;<br>                        condition = condition.substring(<span class="hljs-number">1</span>);<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (StringUtils.isEmpty(condition)) &#123;<br>                        System.out.println(<span class="hljs-string">&quot;输入的type查询条件不符合要求，请重新输入！&quot;</span>);<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br>                    typeValue = condition;<br>                    typeNegation = negation;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition.startsWith(<span class="hljs-string">&quot;text=&quot;</span>)) &#123;<br>                    condition = condition.replace(<span class="hljs-string">&quot;text=&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).trim();<br>                    <span class="hljs-keyword">if</span> (condition.startsWith(<span class="hljs-string">&quot;!&quot;</span>)) &#123;<br>                        negation = <span class="hljs-literal">true</span>;<br>                        condition = condition.substring(<span class="hljs-number">1</span>);<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (StringUtils.isEmpty(condition)) &#123;<br>                        System.out.println(<span class="hljs-string">&quot;输入的text查询条件不符合要求，请重新输入！&quot;</span>);<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br>                    textValue = condition;<br>                    textNegation = negation;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition.startsWith(<span class="hljs-string">&quot;time&quot;</span>)) &#123;<br>                    condition = condition.replace(<span class="hljs-string">&quot;time&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).trim();<br>                    <span class="hljs-keyword">if</span> (condition.startsWith(<span class="hljs-string">&quot;!&quot;</span>)) &#123;<br>                        negation = <span class="hljs-literal">true</span>;<br>                        condition = condition.substring(<span class="hljs-number">1</span>);<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (StringUtils.isEmpty(condition)) &#123;<br>                        System.out.println(<span class="hljs-string">&quot;输入的time查询条件不符合要求，请重新输入！&quot;</span>);<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br>                    timeValue = condition;<br>                    timeNegation = negation;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition.equals(<span class="hljs-string">&quot;&amp;&amp;&quot;</span>)) &#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">nextIndex</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">if</span> (nextIndex &lt; commands.length) &#123;<br>                        <span class="hljs-type">String</span> <span class="hljs-variable">nextCondition</span> <span class="hljs-operator">=</span> commands[nextIndex];<br>                        <span class="hljs-keyword">if</span> (nextCondition.startsWith(<span class="hljs-string">&quot;text=&quot;</span>)) &#123;<br>                            textAnd = <span class="hljs-literal">true</span>;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nextCondition.startsWith(<span class="hljs-string">&quot;time&quot;</span>)) &#123;<br>                            timeAnd = <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition.equals(<span class="hljs-string">&quot;||&quot;</span>)) &#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">nextIndex</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">if</span> (nextIndex &lt; commands.length) &#123;<br>                        <span class="hljs-type">String</span> <span class="hljs-variable">nextCondition</span> <span class="hljs-operator">=</span> commands[nextIndex];<br>                        <span class="hljs-keyword">if</span> (nextCondition.startsWith(<span class="hljs-string">&quot;text=&quot;</span>)) &#123;<br>                            textOr = <span class="hljs-literal">true</span>;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nextCondition.startsWith(<span class="hljs-string">&quot;time&quot;</span>)) &#123;<br>                            timeOr = <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>            List&lt;Note&gt; noteList = searchNote(typeValue, typeNegation,<br>                    textValue, textNegation, textAnd, textOr);<br>            result.addAll(noteList);<br>            List&lt;Task&gt; taskList = searchTask(typeValue, typeNegation,<br>                    textValue, textNegation, textAnd, textOr,<br>                    timeValue, timeNegation, timeAnd, timeOr);<br>            result.addAll(taskList);<br>            List&lt;Event&gt; eventList = searchEvent(typeValue, typeNegation,<br>                    textValue, textNegation, textAnd, textOr,<br>                    timeValue, timeNegation, timeAnd, timeOr);<br>            result.addAll(eventList);<br>            List&lt;Contact&gt; contactList = searchContact(typeValue, typeNegation,<br>                    textValue, textNegation, textAnd, textOr);<br>            result.addAll(contactList);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            result = PimDataService.getAllPir();<br>        &#125;<br>        <span class="hljs-keyword">for</span> (Object pir : result) &#123;<br>            System.out.println(pir);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkType</span><span class="hljs-params">(String typeValue, <span class="hljs-type">boolean</span> typeNegation, String typeKey)</span> &#123;<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(typeValue)) &#123;<br>            <span class="hljs-comment">// 如果没有输入条件type，返回true</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-comment">// 取反操作</span><br>        <span class="hljs-keyword">if</span> (typeNegation) &#123;<br>            <span class="hljs-keyword">return</span> !typeValue.equals(typeKey);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> typeValue.equals(typeKey);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Note&gt; <span class="hljs-title function_">searchNote</span><span class="hljs-params">(String typeValue, <span class="hljs-type">boolean</span> typeNegation,</span><br><span class="hljs-params">                               String textValue, <span class="hljs-type">boolean</span> textNegation,</span><br><span class="hljs-params">                               <span class="hljs-type">boolean</span> textAnd, <span class="hljs-type">boolean</span> textOr)</span> &#123;<br>        List&lt;Note&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (checkType(typeValue, typeNegation, <span class="hljs-string">&quot;note&quot;</span>)) &#123;<br>            List&lt;Note&gt; noteList = searchNoteDetail(textValue, textNegation);<br>            result.addAll(noteList);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (textOr) &#123;<br>                List&lt;Note&gt; noteList = searchNoteDetail(textValue, textNegation);<br>                result.addAll(noteList);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Note&gt; <span class="hljs-title function_">searchNoteDetail</span><span class="hljs-params">(String textValue, <span class="hljs-type">boolean</span> textNegation)</span> &#123;<br>        List&lt;Note&gt; matchList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(textValue)) &#123;<br>            <span class="hljs-keyword">return</span> matchList; <span class="hljs-comment">// PimDataService.notes;</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (textNegation) &#123;<br>            matchList = PimDataService.notes.stream().filter(f -&gt; !f.getContent().contains(textValue)).collect(Collectors.toList());<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            matchList = PimDataService.notes.stream().filter(f -&gt; f.getContent().contains(textValue)).collect(Collectors.toList());<br>        &#125;<br>        <span class="hljs-keyword">return</span> matchList;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Task&gt; <span class="hljs-title function_">searchTask</span><span class="hljs-params">(String typeValue, <span class="hljs-type">boolean</span> typeNegation,</span><br><span class="hljs-params">                                         String textValue, <span class="hljs-type">boolean</span> textNegation,</span><br><span class="hljs-params">                                         <span class="hljs-type">boolean</span> textAnd, <span class="hljs-type">boolean</span> textOr,</span><br><span class="hljs-params">                                         String timeValue, <span class="hljs-type">boolean</span> timeNegation,</span><br><span class="hljs-params">                                         <span class="hljs-type">boolean</span> timeAnd, <span class="hljs-type">boolean</span> timeOr)</span> &#123;<br>        List&lt;Task&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (checkType(typeValue, typeNegation, <span class="hljs-string">&quot;task&quot;</span>)) &#123;<br>            List&lt;Task&gt; taskList = searchTaskDetail(textValue, textNegation, timeValue, timeNegation, timeAnd, timeOr);<br>            result.addAll(taskList);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (textOr) &#123;<br>                List&lt;Task&gt; taskList = searchTaskDetail(textValue, textNegation, timeValue, timeNegation, timeAnd, timeOr);<br>                result.addAll(taskList);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Task&gt; <span class="hljs-title function_">searchTaskDetail</span><span class="hljs-params">(String textValue, <span class="hljs-type">boolean</span> textNegation,</span><br><span class="hljs-params">                                         String timeValue, <span class="hljs-type">boolean</span> timeNegation,</span><br><span class="hljs-params">                                         <span class="hljs-type">boolean</span> timeAnd, <span class="hljs-type">boolean</span> timeOr)</span> &#123;<br>        List&lt;Task&gt; matchList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>        <span class="hljs-keyword">for</span> (Task task : PimDataService.tasks) &#123;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">isMatch</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">if</span> (StringUtils.isEmpty(textValue)) &#123;<br>                <span class="hljs-keyword">if</span> (StringUtils.isEmpty(timeValue)) &#123;<br>                    isMatch = <span class="hljs-literal">true</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (timeNegation) &#123;<br>                        <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (StringUtils.isEmpty(timeValue)) &#123;<br>                    <span class="hljs-keyword">if</span> (textNegation) &#123;<br>                        <span class="hljs-keyword">if</span> (!task.getDescription().contains(textValue)) &#123;<br>                            isMatch = <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">if</span> (task.getDescription().contains(textValue)) &#123;<br>                            isMatch = <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (textNegation) &#123;<br>                        <span class="hljs-type">boolean</span> <span class="hljs-variable">partMath</span> <span class="hljs-operator">=</span> !task.getDescription().contains(textValue);<br>                        <span class="hljs-keyword">if</span> (timeNegation) &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br><br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-type">boolean</span> <span class="hljs-variable">partMath</span> <span class="hljs-operator">=</span> task.getDescription().contains(textValue);<br>                        <span class="hljs-keyword">if</span> (timeNegation) &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br><br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || task.getDeadline().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (isMatch) &#123;<br>                matchList.add(task);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> matchList;<br>    &#125;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Event&gt; <span class="hljs-title function_">searchEvent</span><span class="hljs-params">(String typeValue, <span class="hljs-type">boolean</span> typeNegation,</span><br><span class="hljs-params">                                           String textValue, <span class="hljs-type">boolean</span> textNegation,</span><br><span class="hljs-params">                                           <span class="hljs-type">boolean</span> textAnd, <span class="hljs-type">boolean</span> textOr,</span><br><span class="hljs-params">                                           String timeValue, <span class="hljs-type">boolean</span> timeNegation,</span><br><span class="hljs-params">                                           <span class="hljs-type">boolean</span> timeAnd, <span class="hljs-type">boolean</span> timeOr)</span> &#123;<br>        List&lt;Event&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (checkType(typeValue, typeNegation, <span class="hljs-string">&quot;event&quot;</span>)) &#123;<br>            List&lt;Event&gt; eventList = searchEventDetail(textValue, textNegation, timeValue, timeNegation, timeAnd, timeOr);<br>            result.addAll(eventList);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (textOr) &#123;<br>                List&lt;Event&gt; eventList = searchEventDetail(textValue, textNegation, timeValue, timeNegation, timeAnd, timeOr);<br>                result.addAll(eventList);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Event&gt; <span class="hljs-title function_">searchEventDetail</span><span class="hljs-params">(String textValue, <span class="hljs-type">boolean</span> textNegation,</span><br><span class="hljs-params">                                               String timeValue, <span class="hljs-type">boolean</span> timeNegation,</span><br><span class="hljs-params">                                               <span class="hljs-type">boolean</span> timeAnd, <span class="hljs-type">boolean</span> timeOr)</span> &#123;<br>        List&lt;Event&gt; matchList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>        <span class="hljs-keyword">for</span> (Event event : PimDataService.events) &#123;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">isMatch</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">if</span> (StringUtils.isEmpty(textValue)) &#123;<br>                <span class="hljs-keyword">if</span> (StringUtils.isEmpty(timeValue)) &#123;<br>                    isMatch = <span class="hljs-literal">true</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (timeNegation) &#123;<br>                        <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> ((event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>)) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> ((event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>)) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> ((event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>)) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> ((event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>)) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> ((event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>)) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> ((event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>)) &#123;<br>                                isMatch = <span class="hljs-literal">true</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (StringUtils.isEmpty(timeValue)) &#123;<br>                    <span class="hljs-keyword">if</span> (textNegation) &#123;<br>                        <span class="hljs-keyword">if</span> (!event.getDescription().contains(textValue)) &#123;<br>                            isMatch = <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">if</span> (event.getDescription().contains(textValue)) &#123;<br>                            isMatch = <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (textNegation) &#123;<br>                        <span class="hljs-type">boolean</span> <span class="hljs-variable">partMath</span> <span class="hljs-operator">=</span> !event.getDescription().contains(textValue);<br>                        <span class="hljs-keyword">if</span> (timeNegation) &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br><br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-type">boolean</span> <span class="hljs-variable">partMath</span> <span class="hljs-operator">=</span> event.getDescription().contains(textValue);<br>                        <span class="hljs-keyword">if</span> (timeNegation) &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br><br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (timeAnd) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath &amp;&amp; (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeOr) &#123;<br>                                <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&gt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;=&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timeValue.startsWith(<span class="hljs-string">&quot;&lt;&quot;</span>)) &#123;<br>                                    <span class="hljs-keyword">if</span> (partMath || (event.getStartTime().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span> || event.getAlarm().compareTo(timeValue.substring(<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">0</span>)) &#123;<br>                                        isMatch = <span class="hljs-literal">true</span>;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (isMatch) &#123;<br>                matchList.add(event);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> matchList;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Contact&gt; <span class="hljs-title function_">searchContact</span><span class="hljs-params">(String typeValue, <span class="hljs-type">boolean</span> typeNegation,</span><br><span class="hljs-params">                                               String textValue, <span class="hljs-type">boolean</span> textNegation,</span><br><span class="hljs-params">                                               <span class="hljs-type">boolean</span> textAnd, <span class="hljs-type">boolean</span> textOr)</span> &#123;<br>        List&lt;Contact&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (checkType(typeValue, typeNegation, <span class="hljs-string">&quot;contact&quot;</span>)) &#123;<br>            List&lt;Contact&gt; contactList = searchContactDetail(textValue, textNegation);<br>            result.addAll(contactList);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (textOr) &#123;<br>                List&lt;Contact&gt; contactList = searchContactDetail(textValue, textNegation);<br>                result.addAll(contactList);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Contact&gt; <span class="hljs-title function_">searchContactDetail</span><span class="hljs-params">(String textValue, <span class="hljs-type">boolean</span> textNegation)</span> &#123;<br>        List&lt;Contact&gt; matchList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(textValue)) &#123;<br>            <span class="hljs-keyword">return</span> matchList; <span class="hljs-comment">// PimDataService.contacts;</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (textNegation) &#123;<br>            matchList = PimDataService.contacts.stream().filter(f -&gt; (!f.getName().contains(textValue) || !f.getMobile().contains(textValue) || !f.getAddress().contains(textValue))).collect(Collectors.toList());<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            matchList = PimDataService.contacts.stream().filter(f -&gt; (f.getName().contains(textValue) || f.getMobile().contains(textValue) || f.getAddress().contains(textValue))).collect(Collectors.toList());<br>        &#125;<br>        <span class="hljs-keyword">return</span> matchList;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Class-TaskController"><a href="#Class-TaskController" class="headerlink" title="Class TaskController"></a>Class TaskController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.controller;<br><br><span class="hljs-keyword">import</span> info.pim.model.Task;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Task Controller</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskController</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(Scanner sc, String command)</span> &#123;<br>        String[] commands = command.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">if</span> (commands.length &gt;= <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;list&quot;</span>)) &#123;<br>                list();<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;add&quot;</span>)) &#123;<br>                add(sc);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;edit&quot;</span>)) &#123;<br>                edit(sc, commands);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (commands[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;delete&quot;</span>)) &#123;<br>                delete(commands);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 列表查询</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">list</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Task&gt; tasks = PimDataService.tasks;<br>        System.out.println(<span class="hljs-string">&quot;task list:&quot;</span>);<br>        <span class="hljs-keyword">for</span> (Task task : tasks) &#123;<br>            System.out.println(task);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 添加</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Scanner sc)</span> &#123;<br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>();<br>        task.setId(PimDataService.idWorker.nextId());<br><br>        updateData(sc, task);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 编辑</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">edit</span><span class="hljs-params">(Scanner sc, String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行edit指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> PimDataService.getTask(id);<br>        <span class="hljs-keyword">if</span> (task == <span class="hljs-literal">null</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;指定的event不存在！&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        updateData(sc, task);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateData</span><span class="hljs-params">(Scanner sc, Task task)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;请输入deadline(格式为yyyy-MM-dd， 例如 2023-10-27)：&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">deadline</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        task.setDeadline(deadline);<br>        System.out.println(<span class="hljs-string">&quot;请输入description(当一行输入为[:quit]退出输入操作)：&quot;</span>);<br>        <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">sbDescription</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">description</span> <span class="hljs-operator">=</span> sc.nextLine();<br>            <span class="hljs-keyword">if</span> (description.equals(<span class="hljs-string">&quot;:quit&quot;</span>)) &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            sbDescription.append(description);<br>        &#125;<br>        task.setDescription(sbDescription.toString());<br>        PimDataService.saveTask(task);<br>        System.out.println(<span class="hljs-string">&quot;保存成功！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String[] commands)</span> &#123;<br>        <span class="hljs-keyword">if</span> (commands.length &lt; <span class="hljs-number">3</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;执行delete指令时，请在指令后附带唯一标识id&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> commands[<span class="hljs-number">2</span>];<br>        PimDataService.deleteTask(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Content"><a href="#Content" class="headerlink" title="Content"></a>Content</h2><p><code>info.pim.constant</code> 包含了 <code>Message</code> 接口，该接口定义了程序显示给用户的各种消息的常量。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> info.pim.constant;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 消息提示信息</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Message</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">WELCOME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;=============================欢迎使用PIM系统============================&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> test;<br><br><span class="hljs-keyword">import</span> info.pim.model.Contact;<br><span class="hljs-keyword">import</span> info.pim.model.Event;<br><span class="hljs-keyword">import</span> info.pim.model.Note;<br><span class="hljs-keyword">import</span> info.pim.model.Task;<br><span class="hljs-keyword">import</span> info.pim.service.PimDataService;<br><span class="hljs-keyword">import</span> info.pim.util.DateUtil;<br><span class="hljs-keyword">import</span> org.junit.Before;<br><span class="hljs-keyword">import</span> org.junit.BeforeClass;<br><span class="hljs-keyword">import</span> org.junit.Ignore;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 单元测试</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUnitTest</span> &#123;<br>    <span class="hljs-meta">@BeforeClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initTestData</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这是一个设置方法，它在所有测试之前运行一次以初始化测试数据。它删除任何现有的测试数据文件并加载一个新的。</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">imDataFilePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;data/unit_test_data.pim&quot;</span>;<br>        <span class="hljs-type">File</span> <span class="hljs-variable">pimTestFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imDataFilePath);<br>        <span class="hljs-keyword">if</span> (pimTestFile.exists()) &#123;<br>            pimTestFile.delete();<br>        &#125;<br>        PimDataService.loadPimData(imDataFilePath);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testNoteAdd</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试验证了可以正确添加 Note。</span><br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Note</span>(); <span class="hljs-comment">// 创建一个新的 Note</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> PimDataService.idWorker.nextId(); <span class="hljs-comment">// 使用 PimDataService 保存它</span><br>        note.setId(id);<br>        note.setContent(<span class="hljs-string">&quot;content add&quot;</span>);<br>        <span class="hljs-comment">// add</span><br>        PimDataService.saveNote(note);<br><br>        <span class="hljs-comment">// get add data</span><br>        <span class="hljs-type">Note</span> <span class="hljs-variable">noteSaved</span> <span class="hljs-operator">=</span> PimDataService.getNote(id); <br>        assertSame(note, noteSaved);<br><br>        <span class="hljs-comment">// test print data</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">dataStr</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Note&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, content=&#x27;&quot;</span> + noteSaved.getContent() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        assertEquals(note.toString(), dataStr); <span class="hljs-comment">// 然后检索它并检查检索到的 Note 是否与原始的匹配。</span><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testNoteEdit</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试验证了可以正确编辑 Note。</span><br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> PimDataService.notes.get(<span class="hljs-number">0</span>); <span class="hljs-comment">// 它从列表中获取一个 Note</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> note.getId();<br>        note.setContent(<span class="hljs-string">&quot;content edit&quot;</span>);<br>        <span class="hljs-comment">// edit</span><br>        PimDataService.saveNote(note); <span class="hljs-comment">// 修改它，保存更改</span><br><br>        <span class="hljs-comment">// get edit data</span><br>        <span class="hljs-type">Note</span> <span class="hljs-variable">noteSaved</span> <span class="hljs-operator">=</span> PimDataService.getNote(id);<br>        assertSame(note, noteSaved); <span class="hljs-comment">// 然后再次检索它并检查检索到的 Note 是否与修改后的匹配。</span><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTaskAdd</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试类似于 testNoteAdd()，但它测试了添加 Task。</span><br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> PimDataService.idWorker.nextId();<br>        task.setId(id);<br>        task.setDeadline(DateUtil.date());<br>        task.setDescription(<span class="hljs-string">&quot;description add&quot;</span>);<br>        <span class="hljs-comment">// add</span><br>        PimDataService.saveTask(task);<br><br>        <span class="hljs-comment">// get add data</span><br>        <span class="hljs-type">Task</span> <span class="hljs-variable">taskSaved</span> <span class="hljs-operator">=</span> PimDataService.getTask(id);<br>        assertSame(task, taskSaved);<br><br>        <span class="hljs-comment">// test print data</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">dataStr</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Task&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, deadline=&#x27;&quot;</span> + taskSaved.getDeadline() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, description=&#x27;&quot;</span> + taskSaved.getDescription() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        assertEquals(task.toString(), dataStr);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTaskEdit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> PimDataService.tasks.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> task.getId();<br>        task.setDeadline(DateUtil.date());<br>        task.setDescription(<span class="hljs-string">&quot;description edit&quot;</span>);<br>        <span class="hljs-comment">// edit</span><br>        PimDataService.saveTask(task);<br><br>        <span class="hljs-comment">// get edit data</span><br>        <span class="hljs-type">Task</span> <span class="hljs-variable">taskSaved</span> <span class="hljs-operator">=</span> PimDataService.getTask(id);<br>        assertSame(task, taskSaved);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEventAdd</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> PimDataService.idWorker.nextId();<br>        event.setId(id);<br>        event.setStartTime(DateUtil.date());<br>        event.setAlarm(DateUtil.date());<br>        event.setDescription(<span class="hljs-string">&quot;description add&quot;</span>);<br>        <span class="hljs-comment">// add</span><br>        PimDataService.saveEvent(event);<br><br>        <span class="hljs-comment">// get add data</span><br>        <span class="hljs-type">Event</span> <span class="hljs-variable">eventSaved</span> <span class="hljs-operator">=</span> PimDataService.getEvent(id);<br>        assertSame(event, eventSaved);<br><br>        <span class="hljs-comment">// test print data</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">dataStr</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Event&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, startTime=&#x27;&quot;</span> + eventSaved.getStartTime() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, alarm=&#x27;&quot;</span> + eventSaved.getAlarm() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, description=&#x27;&quot;</span> + eventSaved.getDescription() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        assertEquals(event.toString(), dataStr);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEventEdit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> PimDataService.events.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> event.getId();<br>        event.setStartTime(DateUtil.date());<br>        event.setAlarm(DateUtil.date());<br>        event.setDescription(<span class="hljs-string">&quot;description edit&quot;</span>);<br>        <span class="hljs-comment">// edit</span><br>        PimDataService.saveEvent(event);<br><br>        <span class="hljs-comment">// get edit data</span><br>        <span class="hljs-type">Event</span> <span class="hljs-variable">eventSaved</span> <span class="hljs-operator">=</span> PimDataService.getEvent(id);<br>        assertSame(event, eventSaved);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testContactAdd</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> PimDataService.idWorker.nextId();<br>        contact.setId(id);<br>        contact.setName(<span class="hljs-string">&quot;name add&quot;</span>);<br>        contact.setMobile(<span class="hljs-string">&quot;mobile add&quot;</span>);<br>        contact.setAddress(<span class="hljs-string">&quot;address add&quot;</span>);<br>        <span class="hljs-comment">// add</span><br>        PimDataService.saveContact(contact);<br><br>        <span class="hljs-comment">// get add data</span><br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contactSaved</span> <span class="hljs-operator">=</span> PimDataService.getContact(id);<br>        assertSame(contact, contactSaved);<br><br>        <span class="hljs-comment">// test print data</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">dataStr</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Contact&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, name=&#x27;&quot;</span> + contactSaved.getName() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, address=&#x27;&quot;</span> + contactSaved.getAddress() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, mobile=&#x27;&quot;</span> + contactSaved.getMobile() + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        assertEquals(contact.toString(), dataStr);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testContactEdit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> PimDataService.contacts.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> contact.getId();<br>        contact.setName(<span class="hljs-string">&quot;name edit&quot;</span>);<br>        contact.setMobile(<span class="hljs-string">&quot;mobile edit&quot;</span>);<br>        contact.setAddress(<span class="hljs-string">&quot;address edit&quot;</span>);<br>        <span class="hljs-comment">// edit</span><br>        PimDataService.saveContact(contact);<br><br>        <span class="hljs-comment">// get edit data</span><br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contactSaved</span> <span class="hljs-operator">=</span> PimDataService.getContact(id);<br>        assertSame(contact, contactSaved);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testAllPirData</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试检查 PimDataService 中的 getAllPir() 方法是否返回了正确大小的列表。</span><br>        List&lt;Object&gt; allPir = PimDataService.getAllPir();<br>        assertEquals(<span class="hljs-number">4</span>, allPir.size());<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetPirById</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试验证了 PimDataService 中的 getPirById() 方法是否能够通过它们的 ID 正确检索 Note，Task，Event，或 Contact。</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">noteId</span> <span class="hljs-operator">=</span> PimDataService.notes.get(<span class="hljs-number">0</span>).getId();<br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> (Note) PimDataService.getPirById(noteId);<br>        assertTrue(note != <span class="hljs-literal">null</span> &amp;&amp; note.getId().equals(noteId));<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">taskId</span> <span class="hljs-operator">=</span> PimDataService.tasks.get(<span class="hljs-number">0</span>).getId();<br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> (Task) PimDataService.getPirById(taskId);<br>        assertTrue(task != <span class="hljs-literal">null</span> &amp;&amp; task.getId().equals(taskId));<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">eventId</span> <span class="hljs-operator">=</span> PimDataService.events.get(<span class="hljs-number">0</span>).getId();<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> (Event) PimDataService.getPirById(eventId);<br>        assertTrue(event != <span class="hljs-literal">null</span> &amp;&amp; event.getId().equals(eventId));<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">contactId</span> <span class="hljs-operator">=</span> PimDataService.contacts.get(<span class="hljs-number">0</span>).getId();<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> (Contact) PimDataService.getPirById(contactId);<br>        assertTrue(contact != <span class="hljs-literal">null</span> &amp;&amp; contact.getId().equals(contactId));<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testNoteDelete</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试验证了可以正确删除 Note。它删除一个 Note 并检查之后是否无法检索到它。</span><br>        <span class="hljs-type">Note</span> <span class="hljs-variable">note</span> <span class="hljs-operator">=</span> PimDataService.notes.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> note.getId();<br>        <span class="hljs-comment">// delete</span><br>        PimDataService.deleteNote(id);<br><br>        <span class="hljs-comment">// check delete data</span><br>        <span class="hljs-type">Note</span> <span class="hljs-variable">noteDeleted</span> <span class="hljs-operator">=</span> PimDataService.getNote(id);<br>        assertSame(<span class="hljs-literal">null</span>, noteDeleted);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTaskDelete</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> PimDataService.tasks.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> task.getId();<br>        <span class="hljs-comment">// delete</span><br>        PimDataService.deleteTask(id);<br><br>        <span class="hljs-comment">// check delete data</span><br>        <span class="hljs-type">Task</span> <span class="hljs-variable">taskDeleted</span> <span class="hljs-operator">=</span> PimDataService.getTask(id);<br>        assertSame(<span class="hljs-literal">null</span>, taskDeleted);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEventDelete</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Event</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> PimDataService.events.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> event.getId();<br>        <span class="hljs-comment">// delete</span><br>        PimDataService.deleteEvent(id);<br><br>        <span class="hljs-comment">// check delete data</span><br>        <span class="hljs-type">Event</span> <span class="hljs-variable">eventDeleted</span> <span class="hljs-operator">=</span> PimDataService.getEvent(id);<br>        assertSame(<span class="hljs-literal">null</span>, eventDeleted);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testContactDelete</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> PimDataService.contacts.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> contact.getId();<br>        <span class="hljs-comment">// delete</span><br>        PimDataService.deleteContact(id);<br><br>        <span class="hljs-comment">// check delete data</span><br>        <span class="hljs-type">Contact</span> <span class="hljs-variable">contactDeleted</span> <span class="hljs-operator">=</span> PimDataService.getContact(id);<br>        assertSame(<span class="hljs-literal">null</span>, contactDeleted);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmptyPirData</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 这个测试检查在调用 PimDataService 中的 loadPimData() 方法后，PimDataService 中的所有列表是否为空。</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">imDataFilePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;data/unit_test_data.pim&quot;</span>;<br>        PimDataService.loadPimData(imDataFilePath);<br><br>        assertEquals(<span class="hljs-number">0</span>, PimDataService.notes.size());<br>        assertEquals(<span class="hljs-number">0</span>, PimDataService.tasks.size());<br>        assertEquals(<span class="hljs-number">0</span>, PimDataService.events.size());<br>        assertEquals(<span class="hljs-number">0</span>, PimDataService.contacts.size());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h2><p>在这个 PIM 项目中，主要涉及到的异常有：</p>
<ol>
<li><p><code>FileNotFoundException</code>：当尝试打开的文件不存在时，将抛出此异常。在 <code>PimDataService</code> 类中，当尝试打开 <code>.pim</code> 文件以读取或写入数据时，可能会遇到这种异常。</p>
</li>
<li><p><code>IOException</code>：当发生 I&#x2F;O 错误时，将抛出此异常。在 <code>PimDataService</code> 类中，当读取或写入 <code>.pim</code> 文件时，可能会遇到这种异常。</p>
</li>
<li><p><code>ClassNotFoundException</code>：当应用程序试图加载的类找不到时，将抛出此异常。在 <code>PimDataService</code> 类中，当尝试从 <code>.pim</code> 文件中反序列化对象时，可能会遇到这种异常。</p>
</li>
<li><p><code>NumberFormatException</code>：当应用程序试图将字符串转换为数字，但该字符串的格式不适合数字时，将抛出此异常。在各种控制器类中，当解析用户输入的命令时，可能会遇到这种异常。</p>
</li>
<li><p><code>IllegalArgumentException</code>：当向方法传递非法或不适当的参数时，将抛出此异常。在各种控制器类中，当解析用户输入的命令时，如果命令格式不正确，可能会遇到这种异常。</p>
</li>
</ol>
<p>这些异常都需要在代码中进行适当的处理，以确保程序的健壮性。处理异常的策略可以是捕获并处理异常，或者让异常向上层代码传递。对于 <code>IOException</code>、<code>FileNotFoundException</code> 和 <code>ClassNotFoundException</code> 这些必须处理的异常，一般会在方法签名中使用 <code>throws</code> 关键字声明，以让调用者知道需要处理这些异常。对于 <code>NumberFormatException</code> 和 <code>IllegalArgumentException</code> 这些运行时异常，则可以选择在适当的地方使用 try-catch 语句进行捕获和处理。</p>
<h2 id="Data-stored"><a href="#Data-stored" class="headerlink" title="Data stored"></a>Data stored</h2><p>该项目的数据存储在一个文件中。 默认文件路径 (default file path) 在<code>PimDataService</code>类中设置为“data&#x2F;data.pim”。 如果该文件不存在，则创建该文件，用于存储笔记、任务、事件和联系人的序列化数据。</p>
<p>“PimDataService”类中的“loadPimData”方法负责将文件中的数据加载到相应的列表（“notes”、“tasks”、“events”、“contacts”）中。 <code>savePimData</code> 方法用于将这些列表中的数据保存回文件。</p>
<p>您可以在运行程序时通过传递命令行参数来指定不同的文件路径。 例如，如果您使用参数“mydata.pim”运行程序，则数据将从文件“mydata.pim”加载并保存到文件“mydata.pim”，而不是默认的“data&#x2F;data.pim”。</p>
<p>.pim数据文件采用Java语言中序列化和反序列化的机制进行存储和加载，并转换为Model中的对象列表。<br>存储结构采用hashmap，约定每个list的key为PIR模型的类型：<br>	初始化创建.pim文件时，保存每种key为空list的hashmap对象；<br>	当系统进行数据的创建、更新、删除操作时，同步保存所有类型的list数据到hashmap，并持久化到.pim文件中。</p>
<p>The .pim data file uses the serialization and deserialization mechanism in the Java language to store and load, and is converted into a list of objects in the Model.<br>The storage structure uses hashmap, and it is agreed that the key of each list is the type of PIR model:<br> When initializing the .pim file, save the hashmap object with an empty list for each key;<br> When the system creates, updates, and deletes data, it synchronously saves all types of list data to hashmap and persists it in the .pim file.</p>
<h2 id="MVC-architecture"><a href="#MVC-architecture" class="headerlink" title="MVC architecture"></a>MVC architecture</h2><p>提供的项目确实包含了模型-视图-控制器 (MVC) 架构的元素，尽管它不是严格的实现。 虽然服务包存在于项目中，但它并不直接与传统的 MVC 模式保持一致。</p>
<p>在MVC架构中，职责通常划分如下：</p>
<ul>
<li><p>模型：代表应用程序的数据和业务逻辑。 它封装了数据模型及其相关操作。 在这个项目中，模型包包含<code>Contact</code>、<code>Event</code>、<code>Note</code>和<code>Task</code>类，它们代表数据实体。</p>
</li>
<li><p>视图：处理应用程序的表示逻辑和用户界面。 在此项目中，视图主要由“Main”类中提供的命令行界面（CLI）表示。 它显示菜单、提示用户输入并显示结果。</p>
</li>
<li><p>控制器：充当模型和视图之间的中介。 它从视图接收用户输入，与模型交互以对数据执行操作，并根据模型的状态更新视图。 在这个项目中，控制器包包含<code>ContactController</code>、<code>EventController</code>、<code>NoteController</code>、<code>TaskController</code>、<code>SearchController</code>和<code>PrintController</code>等类。 这些类处理用户命令，调用“PimDataService”类（可以被视为模型的一部分）中的相应方法，并向视图提供必要的数据。</p>
</li>
</ul>
<p>本项目中的服务包，特别是“PimDataService”类，充当数据服务层。它封装了加载、保存和管理存储在文件中的 PIM 数据的操作。 在存储和检索数据方面发挥作用，它可以被视为控制器用来与持久数据交互的支持组件 (It encapsulates operations for loading, saving, and managing PIM data stored in files. Playing a role in storing and retrieving data, it can be viewed as a supporting component used by controllers to interact with persistent data)。</p>
<p>综上所述，该项目虽然没有严格遵循传统的MVC架构，但在一定程度上确实融入了模型、视图和控制器之间的关注点分离。 该服务包提供数据管理功能，供应用程序中的控制器使用。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Projects/" class="category-chain-item">Projects</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Projects/" class="print-no-link">#Projects</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>All My Projects Description</div>
      <div>http://example.com/2023/06/26/ProjectsDescription/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Rocky CHEN</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>June 26, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/06/26/Blockchain/" title="Blockchain">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Blockchain</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/05/21/Midjourney/" title="Midjourney">
                        <span class="hidden-mobile">Midjourney</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    
      <script>
        Fluid.utils.loadComments('#disqus_thread', function() {
          Fluid.utils.createCssLink('https://lib.baomitu.com/disqusjs/1.3.0/disqusjs.css');
          Fluid.utils.createScript('https://lib.baomitu.com/disqusjs/1.3.0/disqus.js', function() {
            new DisqusJS({
              shortname: 'fluid',
              apikey: ''
            });
          });
        });
      </script>
    
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <!-- 鼠标特效 -->
  <script type="text/javascript" src="/js/click.js"></script>
  
    <div class="footer-content">
       <a href="https://ziyangchen.com/" target="_blank" rel="nofollow noopener"><span>Copyright © 2020-2023</span></a> <i class="iconfont icon-love"></i> <a href="https://ziyangchen.com/" target="_blank" rel="nofollow noopener"><span>Rocky CHEN</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>

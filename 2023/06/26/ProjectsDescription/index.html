

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://s1.ax1x.com/2023/08/11/pPn4DER.jpg">
  <link rel="icon" href="https://s1.ax1x.com/2023/08/11/pPn4DER.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Rocky CHEN">
  <meta name="keywords" content="">
  
    <meta name="description" content="Made by Ziyang CHEN, Rocky, 陈子阳  CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)- Made platform schools or companies can store and check applier or worker CVs on the CV Chain Platform- Back">
<meta property="og:type" content="article">
<meta property="og:title" content="All My Projects Description">
<meta property="og:url" content="http://example.com/2023/06/26/ProjectsDescription/index.html">
<meta property="og:site_name" content="Rocky Web">
<meta property="og:description" content="Made by Ziyang CHEN, Rocky, 陈子阳  CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)- Made platform schools or companies can store and check applier or worker CVs on the CV Chain Platform- Back">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pic1.zhimg.com/v2-2ef6b97216f69938663ae3c7c1aa9611_r.jpg?source=1940ef5c">
<meta property="article:published_time" content="2023-06-26T08:02:00.000Z">
<meta property="article:modified_time" content="2023-08-11T15:31:22.873Z">
<meta property="article:author" content="Rocky CHEN">
<meta property="article:tag" content="Projects">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://pic1.zhimg.com/v2-2ef6b97216f69938663ae3c7c1aa9611_r.jpg?source=1940ef5c">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>All My Projects Description - Rocky Web</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Rocky Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>主页 | Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-books"></i>
                <span>目录 | Contents</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于 | About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-stack-overflow-fill"></i>
                <span>更多 | More</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    <span>博客 | Blog</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    <span>标签 | Tag</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/links/">
                    <i class="iconfont icon-friends"></i>
                    <span>伙伴 | Friends</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://pic1.zhimg.com/v2-2ef6b97216f69938663ae3c7c1aa9611_r.jpg?source=1940ef5c') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="All My Projects Description"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-06-26 16:02" pubdate>
          Monday, June 26th 2023, 4:02 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          39k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          324 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> times
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">All My Projects Description</h1>
            
            
              <div class="markdown-body">
                
                <p><em><strong>Made by Ziyang CHEN, Rocky, 陈子阳</strong></em></p>
<hr>
<h2 id="CV-Chain-Blockchain-Developer-HTML-CSS-JS-Python3"><a href="#CV-Chain-Blockchain-Developer-HTML-CSS-JS-Python3" class="headerlink" title="CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)"></a>CV Chain(Blockchain) Developer (HTML + CSS + JS + Python3)</h2><p>- Made platform schools or companies can store and check applier or worker CVs on the CV Chain Platform<br>- Backend Technology using Blockchain &amp; Web Development</p>
<p>Github: <a target="_blank" rel="noopener" href="https://github.com/Team-Unhackable/CV-Chain">https://github.com/Team-Unhackable/CV-Chain</a></p>
<p>Website: <a target="_blank" rel="noopener" href="https://cvchain.skyproton.org/">https://cvchain.skyproton.org/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># This Python script is a simple implementation of a blockchain using the Flask web framework. It also interacts with the LeanCloud platform, a backend as a service provider, to handle user data.</span><br><span class="hljs-comment"># 此 Python 脚本是使用 Flask Web 框架的区块链的简单实现。 它还与作为服务提供商的后端 LeanCloud 平台进行交互，以处理用户数据。</span><br><br><span class="hljs-comment"># Imports necessary modules: The script begins by importing various Python modules such as datetime, json, hashlib, os, and flask. It also imports the leancloud module to interact with LeanCloud. </span><br><span class="hljs-comment"># 导入必要的模块：该脚本首先导入各种 Python 模块，例如 datetime、json、hashlib、os 和flask。 它还导入leancloud模块来与LeanCloud交互。</span><br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify<br><span class="hljs-keyword">import</span> leancloud<br><br><span class="hljs-comment"># Initializes LeanCloud: The leancloud.init() function is called with two empty strings as arguments. Normally, you should replace the &quot;&quot; with your LeanCloud Application ID and Master Key.</span><br><span class="hljs-comment"># 初始化LeanCloud：使用两个空字符串作为参数调用leancloud.init()函数。 通常，这些将是您的 LeanCloud 应用程序 ID 和主密钥。</span><br>leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># Blockchain class: A Blockchain class is defined which has various methods associated with it such as __init__, create_blockchain, get_previous_block, proof_of_work, hash, and is_chain_valid. These methods are used to create a new blockchain, add blocks to the chain, validate the blockchain, and perform other related functions.</span><br><span class="hljs-comment"># 区块链类：定义了一个区块链类，它具有与其关联的各种方法，例如 __init__、create_blockchain、get_previous_block、proof_of_work、hash 和 is_chain_valid。 这些方法用于创建新的区块链、向链添加区块、验证区块链以及执行其他相关功能。</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Blockchain</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.chain = []<br>        self.create_blockchain(proof=<span class="hljs-number">1</span>, previous_hash=<span class="hljs-string">&#x27;0&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_blockchain</span>(<span class="hljs-params">self, proof, previous_hash</span>):<br>        block = &#123;<br>            <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-built_in">len</span>(self.chain) + <span class="hljs-number">1</span>,<br>            <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-built_in">str</span>(datetime.datetime.now()),<br>            <span class="hljs-string">&#x27;proof&#x27;</span>: proof,<br>            <span class="hljs-string">&#x27;previous_hash&#x27;</span>: previous_hash<br>        &#125;<br>        self.chain.append(block)<br>        <span class="hljs-keyword">return</span> block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_previous_block</span>(<span class="hljs-params">self</span>):<br>        last_block = self.chain[-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">return</span> last_block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self, previous_proof</span>):<br>        new_proof = <span class="hljs-number">1</span><br>        check_proof = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">while</span> check_proof <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span>:<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(new_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] == <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                check_proof = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>:<br>                new_proof += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> new_proof<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">self, block</span>):  <span class="hljs-comment"># generate a hash of an entire block</span><br>        encoded_block = json.dumps(block, sort_keys=<span class="hljs-literal">True</span>).encode()<br>        <span class="hljs-keyword">return</span> hashlib.sha256(encoded_block).hexdigest()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_chain_valid</span>(<span class="hljs-params">self, chain</span>):  <span class="hljs-comment"># check if the blockchain is valid</span><br>        previous_block = chain[<span class="hljs-number">0</span>]<br>        block_index = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> block_index &lt; <span class="hljs-built_in">len</span>(chain):<br>            block = chain[block_index]<br>            <span class="hljs-keyword">if</span> block[<span class="hljs-string">&quot;previous_hash&quot;</span>] != self.<span class="hljs-built_in">hash</span>(previous_block):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            current_proof = block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(current_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] != <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_block = block<br>            block_index += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-comment"># Flask application setup: A Flask application is instantiated and a new Blockchain object is created.</span><br><span class="hljs-comment"># Flask 应用程序设置：实例化 Flask 应用程序并创建新的区块链对象。</span><br>app = Flask(__name__)<br><br>blockchain = Blockchain()<br><br><span class="hljs-comment"># def cache_read():</span><br><span class="hljs-comment">#     url = &quot;https://skyproton.org/save/cache.txt&quot;</span><br><span class="hljs-comment">#     file = urllib.request.urlopen(url)</span><br><span class="hljs-comment">#     name = file.readlines()[0].decode(&quot;utf-8&quot;)</span><br><span class="hljs-comment">#     name = name.strip(&#x27;\n&#x27;)</span><br><span class="hljs-comment">#     return name</span><br><br><br><span class="hljs-comment"># LeanCloud interaction functions: Several functions are defined to interact with LeanCloud, including getCacheUserNameList, updateUserNameIndex, hasIndex, and getUserName. These functions retrieve user data from LeanCloud, update user data, and perform other related operations.</span><br><span class="hljs-comment"># LeanCloud交互函数：定义了几个与LeanCloud交互的函数，包括getCacheUserNameList、updateUserNameIndex、hasIndex和getUserName。 这些函数从 LeanCloud 检索用户数据、更新用户数据并执行其他相关操作。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheUserNameList</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">list</span> = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;blockIndex&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query.descending(<span class="hljs-string">&#x27;createdAt&#x27;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>        <span class="hljs-built_in">list</span>.append(user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>))<br>        user.save()<br>    <span class="hljs-comment"># if len(user_list) &gt; 0:</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">updateUserNameIndex</span>(<span class="hljs-params">inUserName, inIndex</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-comment"># for user in user_list:</span><br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;username&#x27;</span>) == inUserName <span class="hljs-keyword">and</span> user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) == <span class="hljs-string">&quot;&quot;</span>):<br>            user.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;blockIndex&#x27;</span>,<span class="hljs-built_in">str</span>(inIndex))<br>            user.save()<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hasIndex</span>(<span class="hljs-params">inUserName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) != <span class="hljs-string">&quot;&quot;</span>):<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUserName</span>(<span class="hljs-params">inRealName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    outName = <span class="hljs-string">&#x27;&#x27;</span><br>    flag = <span class="hljs-literal">False</span><br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>, <span class="hljs-built_in">str</span>(inRealName))<br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>            <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>) == inRealName):<br>                outName = user.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>                flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span> (flag):<br>        <span class="hljs-keyword">return</span> outName<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> flag<br><br><br><span class="hljs-comment"># def addUsersIntoBlock():</span><br><span class="hljs-comment">#     userList = []</span><br><span class="hljs-comment">#     # while (len(userList)==0):</span><br><span class="hljs-comment">#     userList = getCacheUserNameList()</span><br><span class="hljs-comment">#     if (len(userList)!=0):</span><br><span class="hljs-comment">#         for user in userList:</span><br><span class="hljs-comment">#             return block_data(user)</span><br><br><span class="hljs-comment"># Flask routes: Two Flask routes are defined, /block_data and /get_chain. The /block_data route is a GET route that retrieves a list of usernames from LeanCloud, adds them to the blockchain, and writes the blockchain data to JSON files. The /get_chain route is also a GET route that returns the entire blockchain and its length.</span><br><span class="hljs-comment"># Flask 路由：定义了两个 Flask 路由，/block_data 和 /get_chain。 /block_data 路由是一个 GET 路由，它从 LeanCloud 检索用户名列表，将它们添加到区块链，并将区块链数据写入 JSON 文件。 /get_chain 路由也是一个 GET 路由，它返回整个区块链及其长度。</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/block_data&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">block_data</span>():<br>    inNameList = getCacheUserNameList()<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">len</span>(inNameList)&gt;<span class="hljs-number">0</span>):<br>        inName = inNameList.pop()<br>        previous_block = blockchain.get_previous_block()<br>        previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>        proof = blockchain.proof_of_work(previous_proof)<br>        previous_hash = blockchain.<span class="hljs-built_in">hash</span>(previous_block)<br>        block = blockchain.create_blockchain(proof, previous_hash)<br>        response = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: inName,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: block[<span class="hljs-string">&#x27;index&#x27;</span>],<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: block[<span class="hljs-string">&#x27;timestamp&#x27;</span>],<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: block[<span class="hljs-string">&#x27;proof&#x27;</span>],<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: block[<span class="hljs-string">&#x27;previous_hash&#x27;</span>]&#125;<br>        <br>        username = getUserName(inName)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> hasIndex(username)):<br>            updateUserNameIndex(username, block[<span class="hljs-string">&#x27;index&#x27;</span>])<br><br>        json_object = json.dumps(response, indent = <span class="hljs-number">5</span>)<br>    <br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./data/main/main_block_&quot;</span> + <span class="hljs-built_in">str</span>(block[<span class="hljs-string">&#x27;index&#x27;</span>]) + <span class="hljs-string">&quot;.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(json_object)<br>        <br>        os.mkdir(<span class="hljs-string">&quot;./data/&quot;</span> + <span class="hljs-built_in">str</span>(block[<span class="hljs-string">&#x27;index&#x27;</span>]))<br><br>        count = &#123;<span class="hljs-string">&#x27;num&#x27;</span>: <span class="hljs-built_in">len</span>(blockchain.chain)<br>        &#125;<br>        json_count = json.dumps(count, indent = <span class="hljs-number">1</span>)<br>    <br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./count/main.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(json_count)<br>        <br><br>        <span class="hljs-comment">#return jsonify(response), 200</span><br>    <span class="hljs-keyword">return</span> jsonify(response = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: <span class="hljs-literal">None</span>&#125;), <span class="hljs-number">200</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/get_chain&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_chain</span>():<br>    response = &#123;<span class="hljs-string">&#x27;chain&#x27;</span>: blockchain.chain,<br>                <span class="hljs-string">&#x27;length&#x27;</span>: <span class="hljs-built_in">len</span>(blockchain.chain)&#125;<br>    <span class="hljs-keyword">return</span> jsonify(response), <span class="hljs-number">200</span><br><br><span class="hljs-comment"># Application run: Finally, the Flask application is run on host &#x27;0.0.0.0&#x27; and port 5001.</span><br><span class="hljs-comment"># 应用程序运行：最后，Flask 应用程序在主机“0.0.0.0”和端口 5001 上运行。</span><br>app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5001</span>)<br></code></pre></td></tr></table></figure>

<p>The script is part of a larger system. It is designed to create a blockchain, add blocks to the chain when new users are added to the LeanCloud service, and provide a way to retrieve the entire blockchain via a web API. It also creates a new directory for each block and two JSON <em>&#x2F;<em>ˈdʒeɪsn</em>&#x2F;</em> files: one that contains the block data and another that contains the current length of the chain.<br>该脚本是更大系统的一部分。 它旨在创建一个区块链，当新用户添加到 LeanCloud 服务时将区块添加到链中，并提供一种通过 Web API 检索整个区块链的方法。 它还为每个块创建一个新目录和两个 JSON 文件：一个包含块数据，另一个包含链的当前长度。</p>
<p>This is a very basic implementation of a blockchain. It lacks elements like peer-to-peer network, consensus algorithm for resolving conflicts, transaction handling, etc. that you would find in a full-fledged blockchain system like Bitcoin or Ethereum.<br>这是区块链的一个非常基本的实现。它缺乏点对点网络、解决冲突的共识算法、交易处理等元素，而这些元素你会在比特币或以太坊等成熟的区块链系统中找到。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> leancloud<br><br><span class="hljs-comment"># 定义了一个名为getCacheUserNameListLen()的函数，该函数使用LeanCloud的SDK连接到云端数据库，并查询名为UserData的表格中，blockIndex字段为空的记录的数量，并返回该数量。</span><br><span class="hljs-comment"># A function named getCacheUserNameListLen() is defined that uses LeanCloud&#x27;s SDK to connect to the cloud database and query the number of records in a table named UserData with the blockIndex field empty and return that number.</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheUserNameListLen</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">list</span> = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;blockIndex&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(user_list)<br>  <br><span class="hljs-comment"># 使用一个while循环，不断地向URL http://127.0.0.1:5001/block_data 发送GET请求，每隔5秒钟进行一次请求。</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    URL = <span class="hljs-string">&quot;http://127.0.0.1:5001/block_data&quot;</span><br>    <span class="hljs-keyword">if</span> (getCacheUserNameListLen()&gt;<span class="hljs-number">0</span>): <span class="hljs-comment"># 在每次循环中，如果getCacheUserNameListLen()函数返回的值大于0</span><br>        r = requests.get(url = URL)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Get&quot;</span>) <span class="hljs-comment"># 则打印&quot;Get&quot;，表示可以发送请求；</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wait&quot;</span>) <span class="hljs-comment"># 否则打印&quot;Wait&quot;，表示需要等待。</span><br>    time.sleep(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> leancloud<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># 定义了一个名为getCacheBusinessListLen()的函数，该函数使用LeanCloud的SDK连接到云端数据库，并查询名为UserData的表格中，isAdded字段为&quot;f&quot;的记录的数量，并返回该数量。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheBusinessListLen</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    bList = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;isAdded&#x27;</span>, <span class="hljs-string">&quot;f&quot;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(user_list)<br>  <br><span class="hljs-comment"># 使用一个while循环，不断地向URL http://127.0.0.1:5002/block_data 发送GET请求，每隔5秒钟进行一次请求。</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    URL = <span class="hljs-string">&quot;http://127.0.0.1:5002/block_data&quot;</span><br>    <span class="hljs-keyword">if</span> (getCacheBusinessListLen()&gt;<span class="hljs-number">0</span>): <span class="hljs-comment"># 在每次循环中，如果getCacheBusinessListLen()函数返回的值大于0</span><br>        r = requests.get(url = URL)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Get&quot;</span>) <span class="hljs-comment"># 则打印&quot;Get&quot;，表示可以发送请求</span><br>        <br>        <span class="hljs-comment"># 在请求成功后，程序会扫描指定目录下的文件，获取文件数量并将文件序号存储到JSON文件中。</span><br>        <span class="hljs-comment"># 具体来说，程序会遍历目录&quot;/var/www/html/blockchain/data&quot;下的所有文件夹。</span><br>        <span class="hljs-comment"># 对于每个文件夹，如果它包含文件，则程序会找到该文件夹中编号最大的文件，</span><br>        <span class="hljs-comment"># 并将该文件的序号减1写入一个名为&quot;&#123;文件夹编号&#125;.json&quot;的JSON文件中，存储在&quot;./count&quot;目录下。</span><br>        path = <span class="hljs-string">&quot;/var/www/html/blockchain/data&quot;</span><br>        <span class="hljs-built_in">list</span> = os.listdir(path)<br>        number_files = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, number_files+<span class="hljs-number">1</span>):<br>            path = <span class="hljs-string">&quot;/var/www/html/blockchain/data/&quot;</span> + <span class="hljs-built_in">str</span>(i)<br>            subdata_file = os.listdir(path)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(subdata_file) &gt; <span class="hljs-number">0</span>:<br>                index = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">max</span>(subdata_file)[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span><br>                num = &#123;<span class="hljs-string">&#x27;num&#x27;</span>: index&#125;<br>                json_object = json.dumps(num, indent = <span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./count/&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>                    outfile.write(json_object)<br>        <br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wait&quot;</span>) <span class="hljs-comment"># 否则打印&quot;Wait&quot;，表示需要等待。</span><br>    time.sleep(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify<br><span class="hljs-keyword">import</span> leancloud<br><br><span class="hljs-comment"># 区块链类：该类是区块链系统的核心。 它包含处理区块链操作的各种方法，例如创建新区块 (create_blockchain)、获取前一个区块 (get_previous_block)、执行工作证明 (proof_of_work)、为区块生成哈希 (hash) 以及验证区块链 (is_chain_valid)。</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Blockchain</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.chain = []<br>        self.create_blockchain(proof=<span class="hljs-number">1</span>, previous_hash=<span class="hljs-string">&#x27;0&#x27;</span>, UID=<span class="hljs-string">&#x27;0&#x27;</span>, index=<span class="hljs-string">&#x27;1&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_blockchain</span>(<span class="hljs-params">self, proof, previous_hash, UID, index</span>):<br>        <span class="hljs-comment">#index_1 = os.path.splitext(&quot;./data/&quot; + str(UID) + &quot;/&quot; + str(index) + &quot;.json&quot;)[0]</span><br>        block = &#123;<br>            <span class="hljs-comment">#&#x27;index&#x27;: int(index_1[-1:]) + 1,</span><br>            <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-built_in">int</span>(index) + <span class="hljs-number">1</span>,<br>            <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-built_in">str</span>(datetime.datetime.now()),<br>            <span class="hljs-string">&#x27;proof&#x27;</span>: proof,<br>            <span class="hljs-string">&#x27;previous_hash&#x27;</span>: previous_hash<br>        &#125;<br>        self.chain.append(block)<br>        <span class="hljs-keyword">return</span> block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_previous_block</span>(<span class="hljs-params">self</span>):<br>        last_block = self.chain[-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">return</span> last_block<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self, previous_proof</span>):<br>        new_proof = <span class="hljs-number">1</span><br>        check_proof = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">while</span> check_proof <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span>:<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(new_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] == <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                check_proof = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>:<br>                new_proof += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> new_proof<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">self, block</span>):  <span class="hljs-comment"># generate a hash of an entire block</span><br>        encoded_block = json.dumps(block, sort_keys=<span class="hljs-literal">True</span>).encode()<br>        <span class="hljs-keyword">return</span> hashlib.sha256(encoded_block).hexdigest()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_chain_valid</span>(<span class="hljs-params">self, chain</span>):  <span class="hljs-comment"># check if the blockchain is valid</span><br>        previous_block = chain[<span class="hljs-number">0</span>]<br>        block_index = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> block_index &lt; <span class="hljs-built_in">len</span>(chain):<br>            block = chain[block_index]<br>            <span class="hljs-keyword">if</span> block[<span class="hljs-string">&quot;previous_hash&quot;</span>] != self.<span class="hljs-built_in">hash</span>(previous_block):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            current_proof = block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>            hash_operation = hashlib.sha256(<br>                <span class="hljs-built_in">str</span>(current_proof ** <span class="hljs-number">2</span> - previous_proof ** <span class="hljs-number">2</span>).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> hash_operation[:<span class="hljs-number">4</span>] != <span class="hljs-string">&#x27;0000&#x27;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            previous_block = block<br>            block_index += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-comment"># Flask 应用程序：Flask 应用程序提供与区块链系统交互的接口。 路由 /block_data 是处理区块链操作的端点。 它从 LeanCloud 获取业务列表，对于每个业务，它执行工作量证明，在区块链中创建一个新块，然后将此块数据作为 json 文件保存在特定目录中。</span><br><span class="hljs-comment"># Flask app: The Flask application provides an interface to interact with the blockchain system. The route /block_data is the endpoint where the blockchain operations are handled. It fetches the business list from LeanCloud, and for each business, it performs a proof of work, creates a new block in the blockchain and then saves this block data as a json file in a specific directory.</span><br>app = Flask(__name__)<br><br>blockchain = Blockchain()<br><br><span class="hljs-comment"># def cache_read(): 被注释掉，与缓存和更新用户数据等附加功能有关，但当前代码中并未使用它们。</span><br><span class="hljs-comment">#     url = &quot;https://skyproton.org/save/cache.txt&quot;</span><br><span class="hljs-comment">#     file = urllib.request.urlopen(url)</span><br><span class="hljs-comment">#     name = file.readlines()[0].decode(&quot;utf-8&quot;)</span><br><span class="hljs-comment">#     name = name.strip(&#x27;\n&#x27;)</span><br><span class="hljs-comment">#     return name</span><br><br><span class="hljs-comment"># LeanCloud 操作：该代码包含多个与 LeanCloud 服务交互以存储和获取数据的函数。 </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheUserNameList</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">list</span> = []<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;blockIndex&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query.descending(<span class="hljs-string">&#x27;createdAt&#x27;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>        <span class="hljs-built_in">list</span>.append(user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>))<br>        user.save()<br>    <span class="hljs-comment"># if len(user_list) &gt; 0:</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">updateUserNameIndex</span>(<span class="hljs-params">inUserName, inIndex</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-comment"># for user in user_list:</span><br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;username&#x27;</span>) == inUserName <span class="hljs-keyword">and</span> user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) == <span class="hljs-string">&quot;&quot;</span>):<br>            user.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;blockIndex&#x27;</span>,<span class="hljs-built_in">str</span>(inIndex))<br>            user.save()<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hasIndex</span>(<span class="hljs-params">inUserName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;username&#x27;</span>, inUserName)<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        user = user_list[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;blockIndex&#x27;</span>) != <span class="hljs-string">&quot;&quot;</span>):<br>            flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUserName</span>(<span class="hljs-params">inRealName</span>):<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    outName = <span class="hljs-string">&#x27;&#x27;</span><br>    flag = <span class="hljs-literal">False</span><br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>, <span class="hljs-built_in">str</span>(inRealName))<br>    <span class="hljs-keyword">if</span> (query.count()&gt;<span class="hljs-number">0</span>):<br>        user_list = query.find()<br>        <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>            <span class="hljs-keyword">if</span> (user.get(<span class="hljs-string">&#x27;nameOnBlk&#x27;</span>) == inRealName):<br>                outName = user.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>                flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span> (flag):<br>        <span class="hljs-keyword">return</span> outName<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-comment"># 例如，getCacheBusinessList 获取尚未添加到区块链的企业列表（其中“isAdded”等于“f”）。 然后，这些业务将被添加到区块链中并标记为已添加（将“isAdded”设置为“t”）。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCacheBusinessList</span>():<br>    leancloud.init(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    bList = <span class="hljs-built_in">list</span>()<br>    query = leancloud.Query(<span class="hljs-string">&#x27;UserData&#x27;</span>)<br>    query.equal_to(<span class="hljs-string">&#x27;isAdded&#x27;</span>, <span class="hljs-string">&quot;f&quot;</span>)<br>    query.descending(<span class="hljs-string">&#x27;createdAt&#x27;</span>)<br>    user_list = query.find()<br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> user_list:<br>        inList = <span class="hljs-built_in">list</span>()<br>        inList.append(user.get(<span class="hljs-string">&#x27;UID&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;companyType&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;companyName&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;DegreeOrJob&#x27;</span>))<br>        inList.append(user.get(<span class="hljs-string">&#x27;ClassOrYear&#x27;</span>))<br>        bList.append(inList)<br>        user.<span class="hljs-built_in">set</span>(<span class="hljs-string">&quot;isAdded&quot;</span>,<span class="hljs-string">&quot;t&quot;</span>)<br>        user.save()<br>    <span class="hljs-keyword">return</span> bList<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/block_data&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">block_data</span>():<br>    inNameList = getCacheBusinessList()<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">len</span>(inNameList)&gt;<span class="hljs-number">0</span>):<br>        inName = inNameList.pop()<br>        UID = inName[<span class="hljs-number">0</span>]<br>        inType = inName[<span class="hljs-number">1</span>]<br>        inBName = inName[<span class="hljs-number">2</span>]<br>        inData_1 = inName[<span class="hljs-number">3</span>]<br>        inData_2 = inName[<span class="hljs-number">4</span>]<br>        previous_block = blockchain.get_previous_block()<br>        previous_proof = previous_block[<span class="hljs-string">&#x27;proof&#x27;</span>]<br>        proof = blockchain.proof_of_work(previous_proof)<br>        previous_hash = blockchain.<span class="hljs-built_in">hash</span>(previous_block)<br><br>        path = <span class="hljs-string">&quot;/var/www/html/blockchain/data/&quot;</span> + <span class="hljs-built_in">str</span>(UID)<br>        subdata_file = os.listdir(path)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(subdata_file) &gt; <span class="hljs-number">0</span>:<br>            index = <span class="hljs-built_in">max</span>(subdata_file)[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">else</span>:<br>            index = <span class="hljs-number">1</span><br><br>        block = blockchain.create_blockchain(proof, previous_hash, UID, index)<br>        response = &#123;<span class="hljs-string">&#x27;type&#x27;</span>: inType,<br>                    <span class="hljs-string">&#x27;data&#x27;</span>: &#123;<br>                        <span class="hljs-string">&#x27;Name_of_Work_or_Study&#x27;</span>: inBName,<br>                        <span class="hljs-string">&#x27;data_1&#x27;</span>: inData_1,<br>                        <span class="hljs-string">&#x27;data_2&#x27;</span>: inData_2,<br>                    &#125;,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: block[<span class="hljs-string">&#x27;index&#x27;</span>],<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: block[<span class="hljs-string">&#x27;timestamp&#x27;</span>],<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: block[<span class="hljs-string">&#x27;proof&#x27;</span>],<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: block[<span class="hljs-string">&#x27;previous_hash&#x27;</span>]&#125;<br>        <br>        <span class="hljs-comment"># username = getUserName(inName)</span><br>        <span class="hljs-comment"># if (not hasIndex(username)):</span><br>        <span class="hljs-comment">#     updateUserNameIndex(username, block[&#x27;index&#x27;])</span><br><br>        json_object = json.dumps(response, indent = <span class="hljs-number">5</span>)<br>    <br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./data/&quot;</span> + <span class="hljs-built_in">str</span>(UID) + <span class="hljs-string">&quot;/&quot;</span> + <span class="hljs-built_in">str</span>(block[<span class="hljs-string">&#x27;index&#x27;</span>]) + <span class="hljs-string">&quot;.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(json_object)<br><br>        <span class="hljs-comment">#return jsonify(response), 200</span><br>    <span class="hljs-keyword">return</span> jsonify(response = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;index&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;timestamp&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;proof&#x27;</span>: <span class="hljs-literal">None</span>,<br>                    <span class="hljs-string">&#x27;previous_hash&#x27;</span>: <span class="hljs-literal">None</span>&#125;), <span class="hljs-number">200</span><br><br>app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5002</span>) <span class="hljs-comment"># 应用程序运行：最后一行在主机“0.0.0.0”和端口 5002 上运行 Flask 应用程序。</span><br></code></pre></td></tr></table></figure>



<h2 id="A-Blockchain-Implementation-C"><a href="#A-Blockchain-Implementation-C" class="headerlink" title="A Blockchain Implementation (C++)"></a>A Blockchain Implementation (C++)</h2><p>- This program is about Blockchain which is a cryptographic tool. The goal is to be used in Fintech to protect the chronological order of transactions. The user can use this program to store the information that he wants to save, the information can neither be deleted nor modified. And provide the function of displaying chain data to facilitate user queries. If there are malicious changes to transaction data, the program detects and reflects them.<br>- 这个是一个关于加密工具区块链的程序。目标是在金融科技中使用，以保护交易的时间顺序。用户可以使用这个程序来存储他想要保存的信息，这些信息既不能删除也不能修改。并提供链数据显示功能，方便用户查询。如果存在对事务数据的恶意更改，程序将检测并反映这些更改。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// First of all, here is the library of the program. It includes 3 libraries and given files hpp. and a cpp.</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;SHA1.hpp&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;SHA1.cpp&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX 1000</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// The program designs two structures, namely Block and Blockchain. Among them, the Block structure contains the data, number, hash value, and previous hash value of the Block. In order to facilitate the calculation, when we designed the Blockchain structure, we maintained an array of Blocks with a capacity of 1000 and recorded the number of Blocks in the current Blockchain.</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Block</span> &#123; <span class="hljs-comment">// here is the structure of block</span><br>    string Data;  <span class="hljs-comment">// The data that the user wants to enter(store)</span><br>    <span class="hljs-type">int</span> Number; <span class="hljs-comment">// the index of the blocks</span><br>    string p_hash; <span class="hljs-comment">// previous hash value</span><br>    string hash; <span class="hljs-comment">// hash value</span><br>&#125;;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Blockchain</span>&#123; <span class="hljs-comment">// here is the structure of blockchain which is including blocks</span><br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Block</span> BlockArray[MAX]; <span class="hljs-comment">// By default, 1000 blocks can be added</span><br>    <span class="hljs-type">int</span> m_Size;<br>&#125;;<br><br><span class="hljs-comment">// The project is built on the blockchain. This program allows the user to perform four operations: 1. Add a new block 2. Display the chain data 3. Check the integrity of the data 0. Exit the program If the user writes numbers other than these four, such as 4, 5, 6. The system redisplays the menu and asks the user to retype. When the user enters 0 to exit the program.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">showMenu</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// display the menu</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;******************************************************************************************&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;**************************************** Blockchain **************************************&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;********* This is the blockchain menu, you can run related functions by number ***********&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  1. Add a new block                                    *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  2. Search block by given information                  *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  3. Check the integrity of the data                    *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;*                                  0. Exit the program                                   *&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;******************************************************************************************&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// Regarding the first operation, the user can add blocks by himself, store the information (data) that the user wants to store into the blocks, and generate a hash value to ensure security. First, the program checks whether the blockchain&#x27;s memory is full and if not, the following operations are performed.</span><br><span class="hljs-comment">// The system will ask the number of blocks the user wants to add. And then the user could enter the information(data) into it. If x blocks are added successfully, the system will display &quot;You have added x block(s) successfully!!! &quot;. After the user enters the information, the system will automatically calculate its hash value. And store the information of the block in the corresponding structure.</span><br><span class="hljs-comment">// After the first function completes, the system displays the menu again to the user, allowing the user to choose the next step.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addBlocks</span><span class="hljs-params">(Blockchain * blo)</span></span>&#123; <span class="hljs-comment">// This is the function to add blocks</span><br>    <span class="hljs-keyword">if</span> (blo -&gt; m_Size == MAX) &#123; <span class="hljs-comment">// Blocks cannot be added if they reach 1000</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;Adding failure!&quot;</span> &lt;&lt; endl;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Enter the number of blocks you want to add: &quot;</span>;<br>        <span class="hljs-type">int</span> addNum = <span class="hljs-number">0</span>; <span class="hljs-comment">// Initialize the number of blocks that user want to add</span><br>        cin &gt;&gt; addNum;<br>        <span class="hljs-keyword">if</span> (addNum &gt; <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-comment">// Calculate the new space size, the adding number should not be negative</span><br>            <span class="hljs-type">int</span> newSize; <span class="hljs-comment">// 0</span><br>            newSize = blo-&gt;m_Size + addNum;<br>            string data = <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// Initialize the data of block</span><br>            string p_hash = <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// Initialize the previous hash of block</span><br>            <br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size != <span class="hljs-number">0</span>)&#123;<br>                p_hash = blo-&gt;BlockArray[blo-&gt;m_Size - <span class="hljs-number">1</span>].hash; <span class="hljs-comment">// in case previous hash become the initialize value</span><br>            &#125;<br>            <br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = blo-&gt;m_Size; i &lt; newSize; i++) &#123; <span class="hljs-comment">// i = 0, i &lt; 2</span><br>                cout &lt;&lt; endl;<br>                cout&lt;&lt;<span class="hljs-string">&quot;***** Please enter the information of block No.&quot;</span>&lt;&lt;i+<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-string">&quot; *****&quot;</span>&lt;&lt;endl;<br>                cout&lt;&lt;<span class="hljs-string">&quot;\tPlease enter the data: &quot;</span>; cin &gt;&gt; data;<br>                cout &lt;&lt; endl;<br>                <br>                <span class="hljs-function">string <span class="hljs-title">input</span><span class="hljs-params">(data)</span></span>;<br>                SHA1 checksum;<br>                checksum.<span class="hljs-built_in">update</span>(input);<br>                <span class="hljs-type">char</span> hash[<span class="hljs-number">41</span>];<br>                <span class="hljs-built_in">strcpy</span>(hash, checksum.<span class="hljs-built_in">final</span>().<span class="hljs-built_in">c_str</span>());<br>                <br>                blo -&gt; BlockArray[i].Data = data;<br>                blo -&gt; BlockArray[i].Number = i+<span class="hljs-number">1</span>;<br>                blo -&gt; BlockArray[i].p_hash = p_hash;<br>                blo -&gt; BlockArray[i].hash = hash;<br>                <br>                p_hash = hash;<br>                blo -&gt; m_Size++; <span class="hljs-comment">// the size of block could plus 1 after adding 1 block.</span><br>            &#125;<br>            cout &lt;&lt; <span class="hljs-string">&quot;You have added &quot;</span> &lt;&lt; addNum &lt;&lt; <span class="hljs-string">&quot; block(s) successfully!!!&quot;</span> &lt;&lt; endl;<br>            <br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Incorrect input!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// First, the second operation checks if there are blocks in it. If the user directly selects this action without entering a new block, the system will display Empty, the system will redisplay the menu and let the user re-enter.</span><br><span class="hljs-comment">// If there is the block(s), the second operation can display the data of the chain in three ways: 1. the user can display the data of the whole chain by entering the block number. 2. the data of the whole chain. 3. the hash value of a specific block.</span><br><span class="hljs-comment">// If the user enters another number, the program will display: &quot;Input wrong or empty information!&quot;. The And then program redisplays the three query methods.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">findBlock</span><span class="hljs-params">(Blockchain * blo)</span></span>&#123;   <span class="hljs-comment">// display the chain data in a number of ways</span><br>                                    <span class="hljs-comment">// by block number</span><br>                                    <span class="hljs-comment">// the data of the whole chain</span><br>                                    <span class="hljs-comment">// the hash values of a particular block</span><br>    <br>  <span class="hljs-comment">// Take case 1 as an example. When the &quot;select&quot; input by the user is 1, execute case 1. Check if the block is not empty, then compare the &quot;Number&quot; stored in the structure with the number that the user wants to find for traversal and comparison. If found, output the information of the entire chain. The program also designs a Boolean variable check, which is used if the data entered by the user matches, if not found, the program outputs &quot;No corresponding block was found!&quot;. And asked to re-enter the numbers. If the data entered when querying the method is incorrect, the function will exit, and the menu will be redisplayed.</span><br>    <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;1.Search by block number&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;2.Search by the data of the whole chain&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;3.Search by the hash values of a particular block&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Please enter the search method: &quot;</span>;<br>        <span class="hljs-type">int</span> select;<br>        <span class="hljs-type">int</span> S_number; <span class="hljs-comment">// initialize the block number that user will input</span><br>        string data;<br>        string hash;<br>        cin &gt;&gt; select;<br>        <span class="hljs-keyword">if</span> (select == <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">// Search by block number</span><br>            cout &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Please enter the block number you are looking for: &quot;</span>;<br>            cin &gt;&gt; S_number; <span class="hljs-comment">// let user input the block number they want to search</span><br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123;<br>                cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// Display the informations of the block that the user wants to see according to the block number entered by the user</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;***************** Here is the information of block &quot;</span> &lt;&lt; S_number &lt;&lt; <span class="hljs-string">&quot; *****************&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tNumber: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].Number &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tData: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].Data &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].hash &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[S_number<span class="hljs-number">-1</span>].p_hash &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            cout &lt;&lt; endl;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (select == <span class="hljs-number">2</span>)&#123; <span class="hljs-comment">// Search by the data of the whole chain</span><br>            cout &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Please enter the data of the block you are looking for: &quot;</span>;<br>            cin &gt;&gt; data;<br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// Display the informations of the block that the user wants to see according to the block data entered by the user</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size; i++)&#123;<br>                    <span class="hljs-keyword">if</span> (blo-&gt;BlockArray[i].Data == data) &#123;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;***************** Here is the information of block &quot;</span> &lt;&lt; i+<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&quot; *****************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tNumber: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Number &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tData: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Data &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].p_hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                    &#125;   <br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (select == <span class="hljs-number">3</span>)&#123; <span class="hljs-comment">// Search by the hash values of a particular block</span><br>            cout &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Please enter the hash value of the block you are looking for: &quot;</span>;<br>            cin &gt;&gt; hash;<br>            <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// Display the informations of the block that the user wants to see according to the hash values of a particular block entered by the user</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size; i++)&#123;<br>                    <span class="hljs-keyword">if</span> (blo-&gt;BlockArray[i].hash == hash) &#123;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;***************** Here is the information of block &quot;</span> &lt;&lt; i+<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&quot; *****************&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tNumber: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Number &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tData: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].Data &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].p_hash &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;*                                                                      *&quot;</span> &lt;&lt; endl;<br>                        cout &lt;&lt; <span class="hljs-string">&quot;************************************************************************&quot;</span> &lt;&lt; endl;<br>                    &#125;<br>                &#125;<br>            &#125;<br>            <br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;Input wrong or empty information!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// The third operation checks whether there are blocks in it. If not, the program will display &quot;Empty&quot; and the system will redisplay the menu and ask the user to retype.</span><br><span class="hljs-comment">// This function allows the user to check the integrity of the data stored in the chain. The integrity of the data in the chain is judged by comparing the hash value with the previous hash value. When the blockchain already has block information entered by the user. When the user enters Menu number 3, the program will compare the hash value of each block with the previous hash value. Traverse each block, if the previous hash value of the next one is equal to the previous hash value, output &quot;The blocks are integral&quot;.</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Check_integrity</span><span class="hljs-params">(Blockchain * blo)</span></span>&#123; <span class="hljs-comment">// Check the integrity of the data</span><br>    <br>    <span class="hljs-keyword">if</span> (blo-&gt;m_Size == <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// if the size of block is zero, output Empty!</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;Empty!!&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">bool</span> check = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Initialize a Boolean value</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size<span class="hljs-number">-1</span>; i++) &#123; <span class="hljs-comment">// Check all hash values, compare with their previous hash values</span><br>            <span class="hljs-keyword">if</span> (blo-&gt;BlockArray[i+<span class="hljs-number">1</span>].p_hash != blo-&gt;BlockArray[i].hash) &#123;<br>                check = <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        cout &lt;&lt; endl;<br>        <span class="hljs-keyword">if</span> (check) &#123; <span class="hljs-comment">// output the integrity according to the Boolean value</span><br>            cout &lt;&lt; <span class="hljs-string">&quot;\tThe blocks are integral&quot;</span> &lt;&lt; endl;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;\tThe blocks are NOT integral!!!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>        cout &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Below is all hash value of the blockchain: &quot;</span> &lt;&lt; endl; <span class="hljs-comment">// display all the hash values and previous hash values to user for better understanding of the integrity of the blockchain</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blo-&gt;m_Size; i++)&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;\tHash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].hash &lt;&lt; endl;<br>            cout &lt;&lt; <span class="hljs-string">&quot;\tPrevious hash value: &quot;</span> &lt;&lt; blo-&gt;BlockArray[i].p_hash &lt;&lt; endl;<br>            cout &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// In the code, the program creates the Blockchain structure variable &quot;blo&quot; and initializes the current number of blocks in the Blockchain. Calling the menu guarantees that the menu is available to the user every time. select is the user&#x27;s input to perform the corresponding operation.</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Blockchain blo; <span class="hljs-comment">// naming structure</span><br>    blo.m_Size = <span class="hljs-number">0</span>; <span class="hljs-comment">// Initialize the size of blocks</span><br>    <span class="hljs-type">int</span> select = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-built_in">showMenu</span>();<br>        cout &lt;&lt; <span class="hljs-string">&quot;Enter the number of the Menu number: &quot;</span>; cin &gt;&gt; select;<br>        <span class="hljs-keyword">switch</span> (select) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">addBlocks</span>(&amp;blo); <span class="hljs-comment">// This is the function to add blocks</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-built_in">findBlock</span>(&amp;blo); <span class="hljs-comment">// display the chain data in a number of ways by block number, the data of the whole chain or the hash values of a particular block</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>                <span class="hljs-built_in">Check_integrity</span>(&amp;blo); <span class="hljs-comment">// check the integrity of the blocks</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">// enter 0 to end the program</span><br>                cout &lt;&lt; <span class="hljs-string">&quot;Thank you for using.&quot;</span> &lt;&lt; endl;<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">break</span>;<br>                <br>            <span class="hljs-keyword">default</span>:<br>                cout &lt;&lt; <span class="hljs-string">&quot;Please enter correct a number!&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="Multi-thread-Web-Server-Python"><a href="#Multi-thread-Web-Server-Python" class="headerlink" title="Multi-thread Web Server (Python)"></a>Multi-thread Web Server (Python)</h2><p>This is a Python-based web server that is capable of processing HTTP requests from browsers or other clients in a multi-threaded way.</p>
<p>You should first run the program “Server.py” and click on the link on the console. This will navigate to the server’s main menu where you can find links to image files, the “server.txt” log file, modifiable files, and 404 not found. You can click on any link and follow the instructions to access the desired file. If the server hasn’t responded for a while, it may have closed the connection. Please try refreshing and clicking again. After you run it, you can go to the log file to find the request record, including the client address, access time, requested file name and response type for each record.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># import socket, import threading, import os, import time, and from datetime import datetime are Python modules imported at the start of the code. Class Server is defined as the main server class that takes host, port, and html_file parameters in its constructor. It creates a server socket with socket.socket(), sets socket options with setsockopt(), and binds the socket to the host and port with bind(). It then listens for incoming connections with listen().</span><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> http <span class="hljs-keyword">import</span> HTTPStatus<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Server</span>:<br>  <span class="hljs-comment"># __init__: The constructor initializes the server with a specified host and port, and a default html_file to serve when the root directory (&quot;/&quot;) is requested. It also sets up a server socket and binds it to the given address and port.</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, host, port, html_file</span>):<br>        self.host = host<br>        self.port = port<br>        self.html_file = html_file<br>        self.server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>        self.server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number">1</span>)<br>        self.server_socket.bind((self.host, self.port))<br>        self.server_socket.listen()<br><br>    <span class="hljs-comment"># serve_forever: This method starts the server loop, which continuously listens for incoming connections. For each client that connects, it spawns a new thread to handle the client&#x27;s requests, allowing the server to handle multiple clients simultaneously.</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">serve_forever</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Server listening on http://<span class="hljs-subst">&#123;self.host&#125;</span>:<span class="hljs-subst">&#123;self.port&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            client_socket, client_address = self.server_socket.accept()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Accepted connection from <span class="hljs-subst">&#123;client_address&#125;</span>&quot;</span>)<br>            client_thread = threading.Thread(target=self.handle_client, args=(client_socket, client_address))<br>            client_thread.start()<br><br>     <span class="hljs-comment"># handle_client: This method handles a client&#x27;s connection. It reads and parses the client&#x27;s HTTP request, logs the request details, determines what file the client is requesting, and responds appropriately. If the client is requesting a file that exists, it sends the file&#x27;s content with a 200 OK status. If the client is requesting a file that does not exist, it sends a 404 Not Found status. If the client is making a conditional GET request with an If-Modified-Since header, and the requested file has not been modified since the specified date, it sends a 304 Not Modified status.</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_client</span>(<span class="hljs-params">self, client_socket, client_address</span>):<br>        <span class="hljs-keyword">with</span> client_socket:<br>            request = client_socket.recv(<span class="hljs-number">1024</span>).decode()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Received request from <span class="hljs-subst">&#123;client_address&#125;</span>:&quot;</span>)<br>            <span class="hljs-built_in">print</span>(request)<br><br>            <span class="hljs-comment"># Parse the request to determine the specific file being requested</span><br>            headers = request.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            filename = headers[<span class="hljs-number">0</span>].split()[<span class="hljs-number">1</span>]  <span class="hljs-comment"># /</span><br>            method = headers[<span class="hljs-number">0</span>].split()[<span class="hljs-number">0</span>]  <span class="hljs-comment"># Get, Head</span><br><br>            <span class="hljs-comment"># Add logging here</span><br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;server.txt&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>, mode=<span class="hljs-string">&quot;a&quot;</span>) <span class="hljs-keyword">as</span> log_file:<br>                <span class="hljs-keyword">if</span> filename == <span class="hljs-string">&quot;/&quot;</span>:<br>                    log_message = <span class="hljs-string">f&quot;Client address: [<span class="hljs-subst">&#123;client_address[<span class="hljs-number">0</span>]&#125;</span>]\tAccess time: [<span class="hljs-subst">&#123;datetime.now()&#125;</span>]\nFile name: [<span class="hljs-subst">&#123;filename&#125;</span>index.html]\tResponse type: [<span class="hljs-subst">&#123;method&#125;</span> HTTP/1.1 200 OK]\n\n&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    log_message = <span class="hljs-string">f&quot;Client address: [<span class="hljs-subst">&#123;client_address[<span class="hljs-number">0</span>]&#125;</span>]\tAccess time: [<span class="hljs-subst">&#123;datetime.now()&#125;</span>]\nFile name: [<span class="hljs-subst">&#123;filename&#125;</span>]\tResponse type: [<span class="hljs-subst">&#123;method&#125;</span> HTTP/1.1 200 OK]\n\n&quot;</span><br>                log_file.write(log_message)<br><br>            <span class="hljs-keyword">if</span> method == <span class="hljs-string">&#x27;GET&#x27;</span> <span class="hljs-keyword">or</span> method == <span class="hljs-string">&#x27;HEAD&#x27;</span>:<br>              <span class="hljs-comment"># If the method is GET or HEAD, it attempts to retrieve the requested file and sends a response back to the client with the file contents and appropriate headers. Since image files are binary and must be viewed in &quot;rb&quot; mode before being transferred individually, they cannot be read and delivered to the browser immediately. In this manner, the picture returned by the GET request may be seen normally in the browser. If the file has not been updated after being cached by the browser, it will return 304 Not Modified when we reload the website. This indicates that our software can appropriately handle image files and 304 answers. If the file does not exist, it sends a 404 Not Found error. If the file is a directory, it attempts to append index.html to the file path and retrieve that file. </span><br>                <span class="hljs-keyword">if</span> filename == <span class="hljs-string">&#x27;/&#x27;</span>:<br>                    path = self.html_file<br>                <span class="hljs-keyword">else</span>:<br>                    path = filename[<span class="hljs-number">1</span>:]<br><br>                filepath = os.path.join(os.getcwd(), path)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(filepath):<br>                    self.send_error(client_socket, HTTPStatus.NOT_FOUND)<br>                    <span class="hljs-keyword">return</span><br><br>                <span class="hljs-keyword">if</span> os.path.isdir(filepath):<br>                    filepath = os.path.join(filepath, self.html_file)<br><br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                        content = f.read()<br>                        content_length = <span class="hljs-built_in">len</span>(content)<br>                        last_modified = datetime.utcfromtimestamp(os.path.getmtime(filepath)).strftime(<br>                            <span class="hljs-string">&#x27;%a, %d %b %Y %H:%M:%S GMT&#x27;</span>)<br>                        <span class="hljs-comment"># Check for If-Modified-Since header</span><br>                        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;If-Modified-Since&#x27;</span> <span class="hljs-keyword">in</span> request:<br>                            ims = headers[headers.index(<span class="hljs-string">&#x27;If-Modified-Since: &#x27;</span>) + <span class="hljs-number">1</span>].strip()<br>                            ims_time = datetime.strptime(ims, <span class="hljs-string">&#x27;%a, %d %b %Y %H:%M:%S GMT&#x27;</span>)<br>                            <span class="hljs-keyword">if</span> ims_time &gt;= datetime.utcfromtimestamp(os.path.getmtime(filepath)):<br>                                self.send_error(client_socket, HTTPStatus.NOT_MODIFIED) <span class="hljs-comment"># 304 Not Modified</span><br>                                <span class="hljs-keyword">return</span><br>                        <span class="hljs-comment"># Get Response Headers</span><br>                        response_headers = [<br>                            <span class="hljs-string">f&quot;HTTP/1.1 <span class="hljs-subst">&#123;HTTPStatus.OK.value&#125;</span> <span class="hljs-subst">&#123;HTTPStatus.OK.phrase&#125;</span>&quot;</span>,<br>                            <span class="hljs-string">f&quot;Content-Length: <span class="hljs-subst">&#123;content_length&#125;</span>&quot;</span>,<br>                            <span class="hljs-string">f&quot;Last-Modified: <span class="hljs-subst">&#123;last_modified&#125;</span>&quot;</span>,<br>                            <span class="hljs-string">&quot;Connection: keep-alive&quot;</span>,<br>                        ]<br>                        response = <span class="hljs-string">&#x27;\r\n&#x27;</span>.join(response_headers).encode() + <span class="hljs-string">b&#x27;\r\n\r\n&#x27;</span><br>                    <span class="hljs-keyword">if</span> method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>                        response += content<br>                    client_socket.sendall(response)<br>                <span class="hljs-keyword">except</span>:<br>                    self.send_error(client_socket, HTTPStatus.NOT_FOUND) <span class="hljs-comment"># 404 File Not Found</span><br>                    <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_error</span>(<span class="hljs-params">self, client_socket, status</span>): <span class="hljs-comment"># sends an error response to the client with the specified HTTP status.</span><br>        response = <span class="hljs-string">f&quot;HTTP/1.1 <span class="hljs-subst">&#123;status.value&#125;</span> <span class="hljs-subst">&#123;status.phrase&#125;</span>\r\nConnection: close\r\n\r\n&quot;</span><br>        client_socket.sendall(response.encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(): <span class="hljs-comment"># main() creates a new instance of the Server class with a host of 127.0.0.1, port 8000, and the HTML file web.html. It then calls serve_forever() on this instance, which starts the server and listens for incoming connections.</span><br>    server = Server(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">8000</span>, html_file=<span class="hljs-string">&#x27;web.html&#x27;</span>)<br>    server.serve_forever()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<ol>
<li>The <code>main</code> function creates an instance of the <code>Server</code> class with the host <code>127.0.0.1</code> (localhost), the port <code>8000</code>, and the default HTML file <code>web.html</code>, and starts the server.</li>
<li>The <code>if __name__ == &#39;__main__&#39;</code> conditional checks whether the script is being executed directly (rather than being imported as a module), and if so, it calls the <code>main</code> function to start the server.</li>
<li>The code creates a multithreaded HTTP server in Python with sockets and threading. It listens on a given IP address and port and handles requests from clients. It sends static files from the local file system for HTTP GET requests and returns suitable HTTP status codes. It writes client requests to a file called “server.txt” in UTF-8. The code has a class named Server with three methods: <strong>init</strong>(), serve_forever(), and handle_client(). The <strong>init</strong>() method sets up the server TCP socket and binds it to the IP address and port. The serve_forever() method waits for client connections and launches a new thread for each one. The handle_client() method gets and parses the client request, reads the file from the local file system, and sends a response to the client. The main() function makes a Server object and starts serving requests.</li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Projects/" class="category-chain-item">Projects</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Projects/" class="print-no-link">#Projects</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>All My Projects Description</div>
      <div>http://example.com/2023/06/26/ProjectsDescription/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Rocky CHEN</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>June 26, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/06/26/Blockchain/" title="Blockchain">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Blockchain</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/06/26/vlog36/" title="北京vlog#04｜汪苏泷微博扫楼｜自助烤肉｜孔庙-国子监｜端午半日游-景山公园-什刹海-烟袋斜街">
                        <span class="hidden-mobile">北京vlog#04｜汪苏泷微博扫楼｜自助烤肉｜孔庙-国子监｜端午半日游-景山公园-什刹海-烟袋斜街</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    
      <script>
        Fluid.utils.loadComments('#disqus_thread', function() {
          Fluid.utils.createCssLink('https://lib.baomitu.com/disqusjs/1.3.0/disqusjs.css');
          Fluid.utils.createScript('https://lib.baomitu.com/disqusjs/1.3.0/disqus.js', function() {
            new DisqusJS({
              shortname: 'fluid',
              apikey: ''
            });
          });
        });
      </script>
    
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  



  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="http://ziyangchen.com/" target="_blank" rel="nofollow noopener"><span>Copyright © 2020-2023</span></a> <i class="iconfont icon-love"></i> <a href="http://ziyangchen.com/" target="_blank" rel="nofollow noopener"><span>Rocky CHEN</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
